import"./CWj6FrbW.js";import{s as ot,o as qe}from"./BpDpeONt.js";import{q as zt,u as j,g as u,i as me,s as dt,j as Tt,t as y,f as T,k as fe,m as i,l as s,o as w,n as a,r,ap as Yt,x as pt,v as X,e as le}from"./BxrbYPPH.js";import{i as B}from"./C_-0o-f2.js";import{e as Ae,i as Xe}from"./n-s4RcA1.js";import{h as ce}from"./0AlaG3wI.js";import{s as Vt,a as O,r as Nt}from"./BGk8CD_Q.js";import{d as ge,r as be}from"./DKpueC4a.js";import{b as Lt,a as Ye}from"./vV7d1D-f.js";import{l as N,p as g,s as Je,a as Qe}from"./Cqu1rs7T.js";import{c as k}from"./Dcrl4MPd.js";import{g as pe,a as he,p as We}from"./C6eE29Wt.js";import{a as $e,s as S,c as Ut,f as to,b as eo}from"./iREZRceN.js";import{g as xe}from"./DOeRUQ82.js";import{p as oo}from"./DkujJYMu.js";import"./69_IOA4Y.js";import{R as Jt}from"./bXPwB9uh.js";import{R as ao}from"./BjXv7c3i.js";import{C as de}from"./DC-n8TqT.js";import{R as ue}from"./DpfUluG8.js";import{R as _e}from"./BQuL__OT.js";import{M as Dt}from"./IkWuq9-R.js";import{I as Pt}from"./BtboDQMP.js";import{o as ro}from"./Bxbzq6E6.js";function Pa(l,t,_){return{handle_bookmark_changed:n=>{const{post_id:o,action:d,user_id:v}=n,U=l().map(z=>{if(z.id!==o)return z;let h=z.post_bookmarks||[];return d==="add"?h=[...h,{user_id:v}]:d==="remove"&&(h=h.filter(Y=>Y.user_id!==v)),{...z,post_bookmarks:h}});t(U)},handle_vote_changed:n=>{const{post_id:o,user_vote:d,like_count:v}=n,U=l().map(z=>{if(z.id!==o)return z;let h=z.post_votes||[];const Y=h.findIndex(x=>x.user_id===_.id);return d===0?h=h.filter(x=>x.user_id!==_.id):Y>=0?h[Y]={user_id:_.id,vote:d}:h=[...h,{user_id:_.id,vote:d}],{...z,post_votes:h,like_count:v}});t(U)}}}var so=zt('<svg><path d="M5 2H19C19.5523 2 20 2.44772 20 3V22.1433C20 22.4194 19.7761 22.6434 19.5 22.6434C19.4061 22.6434 19.314 22.6168 19.2344 22.5669L12 18.0313L4.76559 22.5669C4.53163 22.7136 4.22306 22.6429 4.07637 22.4089C4.02647 22.3293 4 22.2373 4 22.1433V3C4 2.44772 4.44772 2 5 2Z"></path></svg>');function Qt(l,t){const _=N(t,["children","$$slots","$$events","$$legacy"]),b=N(_,["size","color","label","class"]);let m=g(t,"size",8,"1em"),n=g(t,"color",8,"currentColor"),o=g(t,"label",8,""),d=g(t,"class",8,"");var v=so();let p;j(()=>p=Vt(v,p,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:m(),height:m(),fill:n(),"aria-label":o()?o():void 0,"aria-hidden":o()?void 0:"true",role:o()?"img":void 0,class:`remixicon ri-bookmark-fill ${d()??""}`,...b})),u(l,v)}var io=zt('<svg><path d="M22 15H19V3H22C22.5523 3 23 3.44772 23 4V14C23 14.5523 22.5523 15 22 15ZM16.7071 16.2929L10.3066 22.6934C10.1307 22.8693 9.85214 22.8891 9.65308 22.7398L8.8005 22.1004C8.3158 21.7369 8.09739 21.1174 8.24686 20.5303L9.40017 16H3C1.89543 16 1 15.1046 1 14V11.8957C1 11.6344 1.05118 11.3757 1.15064 11.1342L4.24501 3.61925C4.3993 3.24455 4.76447 3 5.16969 3H16C16.5523 3 17 3.44772 17 4V15.5858C17 15.851 16.8946 16.1054 16.7071 16.2929Z"></path></svg>');function no(l,t){const _=N(t,["children","$$slots","$$events","$$legacy"]),b=N(_,["size","color","label","class"]);let m=g(t,"size",8,"1em"),n=g(t,"color",8,"currentColor"),o=g(t,"label",8,""),d=g(t,"class",8,"");var v=io();let p;j(()=>p=Vt(v,p,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:m(),height:m(),fill:n(),"aria-label":o()?o():void 0,"aria-hidden":o()?void 0:"true",role:o()?"img":void 0,class:`remixicon ri-thumb-down-fill ${d()??""}`,...b})),u(l,v)}var lo=zt('<svg><path d="M9.40017 16H3C1.89543 16 1 15.1046 1 14V11.8957C1 11.6344 1.05118 11.3757 1.15064 11.1342L4.24501 3.61925C4.3993 3.24455 4.76447 3 5.16969 3H22C22.5523 3 23 3.44772 23 4V14C23 14.5523 22.5523 15 22 15H18.5182C18.1932 15 17.8886 15.1579 17.7012 15.4233L12.2478 23.149C12.1053 23.3508 11.8367 23.4184 11.6157 23.3078L9.80163 22.4008C8.74998 21.875 8.20687 20.6874 8.49694 19.548L9.40017 16ZM17 13.4125V5H5.83939L3 11.8957V14H9.40017C10.7049 14 11.6602 15.229 11.3384 16.4934L10.4351 20.0414C10.3771 20.2693 10.4857 20.5068 10.6961 20.612L11.3572 20.9425L16.0673 14.27C16.3172 13.9159 16.6366 13.6257 17 13.4125ZM19 13H21V5H19V13Z"></path></svg>');function co(l,t){const _=N(t,["children","$$slots","$$events","$$legacy"]),b=N(_,["size","color","label","class"]);let m=g(t,"size",8,"1em"),n=g(t,"color",8,"currentColor"),o=g(t,"label",8,""),d=g(t,"class",8,"");var v=lo();let p;j(()=>p=Vt(v,p,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:m(),height:m(),fill:n(),"aria-label":o()?o():void 0,"aria-hidden":o()?void 0:"true",role:o()?"img":void 0,class:`remixicon ri-thumb-down-line ${d()??""}`,...b})),u(l,v)}var uo=zt('<svg><path d="M2 8.99997H5V21H2C1.44772 21 1 20.5523 1 20V9.99997C1 9.44769 1.44772 8.99997 2 8.99997ZM7.29289 7.70708L13.6934 1.30661C13.8693 1.13066 14.1479 1.11087 14.3469 1.26016L15.1995 1.8996C15.6842 2.26312 15.9026 2.88253 15.7531 3.46966L14.5998 7.99997H21C22.1046 7.99997 23 8.8954 23 9.99997V12.1043C23 12.3656 22.9488 12.6243 22.8494 12.8658L19.755 20.3807C19.6007 20.7554 19.2355 21 18.8303 21H8C7.44772 21 7 20.5523 7 20V8.41419C7 8.14897 7.10536 7.89462 7.29289 7.70708Z"></path></svg>');function _o(l,t){const _=N(t,["children","$$slots","$$events","$$legacy"]),b=N(_,["size","color","label","class"]);let m=g(t,"size",8,"1em"),n=g(t,"color",8,"currentColor"),o=g(t,"label",8,""),d=g(t,"class",8,"");var v=uo();let p;j(()=>p=Vt(v,p,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:m(),height:m(),fill:n(),"aria-label":o()?o():void 0,"aria-hidden":o()?void 0:"true",role:o()?"img":void 0,class:`remixicon ri-thumb-up-fill ${d()??""}`,...b})),u(l,v)}var vo=zt('<svg><path d="M14.5998 8.00033H21C22.1046 8.00033 23 8.89576 23 10.0003V12.1047C23 12.3659 22.9488 12.6246 22.8494 12.8662L19.755 20.3811C19.6007 20.7558 19.2355 21.0003 18.8303 21.0003H2C1.44772 21.0003 1 20.5526 1 20.0003V10.0003C1 9.44804 1.44772 9.00033 2 9.00033H5.48184C5.80677 9.00033 6.11143 8.84246 6.29881 8.57701L11.7522 0.851355C11.8947 0.649486 12.1633 0.581978 12.3843 0.692483L14.1984 1.59951C15.25 2.12534 15.7931 3.31292 15.5031 4.45235L14.5998 8.00033ZM7 10.5878V19.0003H18.1606L21 12.1047V10.0003H14.5998C13.2951 10.0003 12.3398 8.77128 12.6616 7.50691L13.5649 3.95894C13.6229 3.73105 13.5143 3.49353 13.3039 3.38837L12.6428 3.0578L7.93275 9.73038C7.68285 10.0844 7.36341 10.3746 7 10.5878ZM5 11.0003H3V19.0003H5V11.0003Z"></path></svg>');function mo(l,t){const _=N(t,["children","$$slots","$$events","$$legacy"]),b=N(_,["size","color","label","class"]);let m=g(t,"size",8,"1em"),n=g(t,"color",8,"currentColor"),o=g(t,"label",8,""),d=g(t,"class",8,"");var v=vo();let p;j(()=>p=Vt(v,p,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:m(),height:m(),fill:n(),"aria-label":o()?o():void 0,"aria-hidden":o()?void 0:"true",role:o()?"img":void 0,class:`remixicon ri-thumb-up-line ${d()??""}`,...b})),u(l,v)}var fo=zt('<svg><path d="M14 14.252V16.3414C13.3744 16.1203 12.7013 16 12 16C8.68629 16 6 18.6863 6 22H4C4 17.5817 7.58172 14 12 14C12.6906 14 13.3608 14.0875 14 14.252ZM12 13C8.685 13 6 10.315 6 7C6 3.685 8.685 1 12 1C15.315 1 18 3.685 18 7C18 10.315 15.315 13 12 13ZM12 11C14.21 11 16 9.21 16 7C16 4.79 14.21 3 12 3C9.79 3 8 4.79 8 7C8 9.21 9.79 11 12 11ZM17.7929 19.9142L21.3284 16.3787L22.7426 17.7929L17.7929 22.7426L14.2574 19.2071L15.6716 17.7929L17.7929 19.9142Z"></path></svg>');function go(l,t){const _=N(t,["children","$$slots","$$events","$$legacy"]),b=N(_,["size","color","label","class"]);let m=g(t,"size",8,"1em"),n=g(t,"color",8,"currentColor"),o=g(t,"label",8,""),d=g(t,"class",8,"");var v=fo();let p;j(()=>p=Vt(v,p,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:m(),height:m(),fill:n(),"aria-label":o()?o():void 0,"aria-hidden":o()?void 0:"true",role:o()?"img":void 0,class:`remixicon ri-user-follow-line ${d()??""}`,...b})),u(l,v)}var bo=zt('<svg><path d="M14 14.252V16.3414C13.3744 16.1203 12.7013 16 12 16C8.68629 16 6 18.6863 6 22H4C4 17.5817 7.58172 14 12 14C12.6906 14 13.3608 14.0875 14 14.252ZM12 13C8.685 13 6 10.315 6 7C6 3.685 8.685 1 12 1C15.315 1 18 3.685 18 7C18 10.315 15.315 13 12 13ZM12 11C14.21 11 16 9.21 16 7C16 4.79 14.21 3 12 3C9.79 3 8 4.79 8 7C8 9.21 9.79 11 12 11ZM19 17.5858L21.1213 15.4645L22.5355 16.8787L20.4142 19L22.5355 21.1213L21.1213 22.5355L19 20.4142L16.8787 22.5355L15.4645 21.1213L17.5858 19L15.4645 16.8787L16.8787 15.4645L19 17.5858Z"></path></svg>');function po(l,t){const _=N(t,["children","$$slots","$$events","$$legacy"]),b=N(_,["size","color","label","class"]);let m=g(t,"size",8,"1em"),n=g(t,"color",8,"currentColor"),o=g(t,"label",8,""),d=g(t,"class",8,"");var v=bo();let p;j(()=>p=Vt(v,p,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:m(),height:m(),fill:n(),"aria-label":o()?o():void 0,"aria-hidden":o()?void 0:"true",role:o()?"img":void 0,class:`remixicon ri-user-unfollow-line ${d()??""}`,...b})),u(l,v)}var ho=(l,t)=>t(!1),xo=(l,t)=>w(t,a(t)+1),wo=(l,t)=>w(t,a(t)+10),yo=(l,t)=>w(t,a(t)+100),ko=(l,t)=>w(t,a(t)+1e3),Co=(l,t)=>w(t,a(t)+1e4),Lo=(l,t,_)=>{t(!1),w(_,!0)},zo=(l,t)=>t(!1),Vo=y('<div class="p-4"><div class="flex justify-between"><h3 class="font-semibold"> </h3> <button><!></button></div> <div class="mt-6"><p class="flex gap-1 font-semibold">ì„ ë¬¼í•  ë¬¸ <!></p> <input type="number" class="input mt-4 w-full border-none bg-gray-100 text-sm focus:outline-none"> <div class="mt-2 flex gap-2"><button class="btn btn-sm rounded-full">+1</button> <button class="btn btn-sm rounded-full">+10</button> <button class="btn btn-sm rounded-full">+100</button> <button class="btn btn-sm rounded-full">+1,000</button> <button class="btn btn-sm rounded-full">+10,000</button></div></div> <textarea rows="1" placeholder="ì„ ë¬¼ ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”" class="mt-6 w-full resize-none rounded-sm bg-gray-100 p-2 text-sm transition-all focus:outline-none" style="overflow-y: hidden;"></textarea> <div class="my-4 flex items-center justify-between text-sm"><p>ë³´ìœ  ë¬¸ <span class="text-primary"> </span></p> <button class="btn btn-primary btn-outline-none btn-sm">ì¶©ì „</button></div> <div class="mt-4 flex justify-center gap-4"><button class="btn flex-1">ë‹«ê¸°</button> <button class="btn btn-primary flex-1">ì„ ë¬¼í•˜ê¸°</button></div></div>'),Mo=(l,t)=>w(t,!1),Ho=(l,t)=>a(t).point=a(t).point+1,Eo=(l,t)=>a(t).point=a(t).point+10,Ro=(l,t)=>a(t).point=a(t).point+100,Io=(l,t)=>a(t).point=a(t).point+1e3,Zo=(l,t)=>a(t).point=a(t).point+1e4,Po=y('<div class="p-4"><div class="flex justify-between"><h3 class="font-semibold">ë¬¸ ì¶©ì „í•˜ê¸°</h3> <button><!></button></div> <div class="mt-6"><p class="flex gap-1 font-semibold">ì¶©ì „í•  ë¬¸ <!></p> <input type="number" class="input mt-4 w-full border-none bg-gray-100 text-sm focus:outline-none"> <div class="mt-2 flex gap-2"><button class="btn btn-sm rounded-full">+1</button> <button class="btn btn-sm rounded-full">+10</button> <button class="btn btn-sm rounded-full">+100</button> <button class="btn btn-sm rounded-full">+1,000</button> <button class="btn btn-sm rounded-full">+10,000</button></div></div> <div class="mt-6"><p class="text-sm font-medium">ì…ê¸ˆìëª…</p> <input type="text" class="mt-2 w-full rounded-sm bg-gray-100 p-2 text-sm transition-all focus:outline-none"></div> <div class="mt-4"><p class="text-sm font-medium">ì€í–‰</p> <input type="text" class="mt-2 w-full rounded-sm bg-gray-100 p-2 text-sm transition-all focus:outline-none"></div> <div class="mt-4"><p class="text-sm font-medium">ê³„ì¢Œë²ˆí˜¸</p> <input type="text" class="mt-2 w-full rounded-sm bg-gray-100 p-2 text-sm transition-all focus:outline-none"></div> <div class="my-4 h-px bg-gray-200"></div> <div><div class="flex justify-between"><p class="font-semibold">ì´ ê²°ì œ ê¸ˆì•¡</p> <p class="text-primary text-lg font-bold"> </p></div></div> <div class="font-semibod mt-2 flex flex-col justify-center bg-gray-50 px-4 py-2 text-sm text-gray-900"><p>ì•„ì§ì€ ê³„ì¢Œì´ì²´ë§Œ ì§€ì›ë˜ê³  ìˆì–´ìš”!<br> ë” í¸ë¦¬í•œ ê²°ì œë¥¼ ìœ„í•´ ë‹¤ì–‘í•œ ìˆ˜ë‹¨ì„ ì¤€ë¹„ ì¤‘ì´ë‹ˆ ì¡°ê¸ˆë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš” ğŸ˜Š</p></div> <button class="btn btn-primary mt-4 w-full rounded-lg">ë¬¸ ì¶©ì „í•˜ê¸°</button></div>'),Uo=y("<!> <!>",1);function Bo(l,t){me(t,!0);let _=g(t,"is_modal_open",7);const b=pe(),m=he();let n=dt(Tt({point:10,bank:"",account_number:"",account_holder:""})),o=dt(10),d=dt(""),v=dt(!1);const p=async()=>{if(a(o)>b.moon_point){S("error","ë³´ìœ  ë¬¸ì´ ë¶€ì¡±í•©ë‹ˆë‹¤.");return}try{await m.users.gift_moon(b.id,t.receiver_id,a(o)),await m.moon_point_transactions.insert({user_id:b.id,amount:-a(o),type:"gift",description:"ë¬¸ ì„ ë¬¼"}),await m.moon_point_transactions.insert({user_id:t.receiver_id,amount:a(o),type:"receive",description:"ë¬¸ ì„ ë¬¼ ë°›ìŒ"});try{await m.notifications.insert({recipient_id:t.receiver_id,actor_id:b.id,type:"gift.received",resource_type:"user",resource_id:String(t.receiver_id),payload:{amount:a(o),post_id:t.post_id},link_url:`/@${b.handle}/accounts/point`})}catch(x){console.error("Failed to insert notification (gift.received):",x)}t.onGiftSuccess?.({gift_content:a(d),gift_moon_point:a(o),post_id:t.post_id}),b.moon_point=b.moon_point-a(o),_(!1),w(o,10),w(d,""),S("success","ì„±ê³µì ìœ¼ë¡œ ì„ ë¬¼ì„ ë³´ëƒˆìŠµë‹ˆë‹¤.")}catch(x){S("error",x.message),console.error(x)}},U=async()=>{if(!a(n).point||a(n).point<=0){S("error","ì¶©ì „í•  ë¬¸ ê°œìˆ˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");return}if(!a(n).account_holder.trim()){S("error","ì…ê¸ˆìëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");return}if(!a(n).bank.trim()){S("error","ì€í–‰ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");return}if(!a(n).account_number.trim()){S("error","ê³„ì¢Œë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");return}try{const x=Math.floor(a(n).point*100*1.1);await m.moon_charges.create_charge_request({user_id:b.id,point:a(n).point,amount:x,bank:a(n).bank,account_number:a(n).account_number,account_holder:a(n).account_holder}),w(n,{point:10,bank:"",account_number:"",account_holder:""},!0),w(v,!1),S("success","ì¶©ì „ ìš”ì²­ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ê´€ë¦¬ì ìŠ¹ì¸ í›„ ë¬¸ì´ ì¶©ì „ë©ë‹ˆë‹¤.")}catch(x){S("error",x.message),console.error(x)}};var z=Uo(),h=T(z);Dt(h,{modal_position:"center",get is_modal_open(){return _()},set is_modal_open(x){_(x)},children:(x,ut)=>{var M=Vo(),P=s(M),J=s(P),Q=s(J);r(J);var W=i(J,2);W.__click=[ho,_];var at=s(W);ue(at,{size:24,get color(){return k.gray[400]}}),r(W),r(P);var q=i(P,2),$=s(q),Mt=i(s($));_e(Mt,{size:16,get color(){return k.primary}}),r($);var rt=i($,2);O(rt,"min",1),rt.defaultValue=10;var _t=i(rt,2),ht=s(_t);ht.__click=[xo,o];var xt=i(ht,2);xt.__click=[wo,o];var Ht=i(xt,2);Ht.__click=[yo,o];var tt=i(Ht,2);tt.__click=[ko,o];var vt=i(tt,2);vt.__click=[Co,o],r(_t),r(q);var st=i(q,2);be(st);var it=i(st,2),nt=s(it),lt=i(s(nt)),mt=s(lt);r(lt),r(nt);var Et=i(nt,2);Et.__click=[Lo,_,v],r(it);var ft=i(it,2),gt=s(ft);gt.__click=[zo,_];var bt=i(gt,2);bt.__click=p,r(ft),r(M),j(()=>{ot(Q,`${t.receiver_name??""}ë‹˜ê»˜ ì„ ë¬¼í•˜ê¸°`),ot(mt,`${b.moon_point??0??""}ê°œ`),bt.disabled=a(o)===0||a(o)===null}),Lt(rt,()=>a(o),R=>w(o,R)),Lt(st,()=>a(d),R=>w(d,R)),u(x,M)},$$slots:{default:!0}});var Y=i(h,2);Dt(Y,{modal_position:"center",get is_modal_open(){return a(v)},set is_modal_open(x){w(v,x,!0)},children:(x,ut)=>{var M=Po(),P=s(M),J=i(s(P),2);J.__click=[Mo,v];var Q=s(J);ue(Q,{size:24,get color(){return k.gray[400]}}),r(J),r(P);var W=i(P,2),at=s(W),q=i(s(at));_e(q,{size:16,get color(){return k.primary}}),r(at);var $=i(at,2);O($,"min",1),$.defaultValue=10;var Mt=i($,2),rt=s(Mt);rt.__click=[Ho,n];var _t=i(rt,2);_t.__click=[Eo,n];var ht=i(_t,2);ht.__click=[Ro,n];var xt=i(ht,2);xt.__click=[Io,n];var Ht=i(xt,2);Ht.__click=[Zo,n],r(Mt),r(W);var tt=i(W,2),vt=i(s(tt),2);Nt(vt),r(tt);var st=i(tt,2),it=i(s(st),2);Nt(it),r(st);var nt=i(st,2),lt=i(s(nt),2);Nt(lt),r(nt);var mt=i(nt,4),Et=s(mt),ft=i(s(Et),2),gt=s(ft);r(ft),r(Et),r(mt);var bt=i(mt,4);bt.__click=U,r(M),j(R=>ot(gt,`${R??""}ì›`),[()=>$e(Math.floor(a(n).point*100*1.1))]),Lt($,()=>a(n).point,R=>a(n).point=R),Lt(vt,()=>a(n).account_holder,R=>a(n).account_holder=R),Lt(it,()=>a(n).bank,R=>a(n).bank=R),Lt(lt,()=>a(n).account_number,R=>a(n).account_number=R),u(x,M)},$$slots:{default:!0}}),u(l,z),fe()}ge(["click"]);function ve(l,t){eo(a(t),"ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.")}var Ko=y('<button class="btn btn-sm h-6">íŒ”ë¡œì‰</button>'),So=y('<button class="btn btn-sm btn-primary h-6">íŒ”ë¡œìš°</button>'),jo=y('<button aria-label="ê²Œì‹œë¬¼ ë©”ë‰´ ì—´ê¸°"><!></button>'),Fo=y('<video controls preload="metadata" class="w-full rounded-lg" style="max-height: 320px;"><track kind="captions" label="No captions"></video>',2),To=y('<figure class="mt-2"><!></figure>'),No=y('<!> <div class="prose prose-sm mt-2 max-w-none text-sm" style="white-space: pre-wrap;"><!></div>',1),Do=y('<video controls preload="metadata" class="w-full rounded-lg" style="max-height: 320px;"><track kind="captions" label="No captions"></video>',2),Go=y('<figure class="mt-2"><!></figure>'),Oo=(l,t)=>xe(t),qo=(l,t)=>l.key==="Enter"&&xe(t),Ao=y('<div role="button" tabindex="0" class="cursor-pointer"><div class="prose prose-sm mt-2 max-w-none text-sm" style="max-height: 10rem; overflow: hidden; position: relative;"><!> <div style="position: absolute; bottom: 0; left: 0; right: 0; height: 2rem; background: linear-gradient(transparent, white); pointer-events: none;"></div></div></div>'),Xo=y('<a class="mt-2 inline-block rounded bg-gray-100 px-2 py-1 text-[11px]"> </a>'),Yo=(l,t,_)=>t(_.LIKE),Jo=(l,t,_)=>t(_.DISLIKE),Qo=y('<!> <p class="text-gray-600">ì €ì¥ë¨</p>',1),Wo=y('<!> <p class="text-gray-600">ì €ì¥í•˜ê¸°</p>',1),$o=y('<div class="flex w-full flex-col items-center rounded-lg bg-white"><a class="flex w-full items-center gap-3 p-3"><!> <p class="text-gray-600">ìˆ˜ì •í•˜ê¸°</p></a> <hr class="w-full border-gray-100"> <button class="flex w-full items-center gap-3 p-3"><!></button></div> <button class="mt-4 flex w-full flex-col items-center rounded-lg bg-white"><div class="flex w-full items-center gap-3 p-3"><!> <p class="text-gray-600">ë§í¬ë³µì‚¬</p></div></button>',1),ta=y('<!> <p class="text-gray-600">ì €ì¥ë¨</p>',1),ea=y('<!> <p class="text-gray-600">ì €ì¥í•˜ê¸°</p>',1),oa=y('<!> <p class="text-gray-600">íŒ”ë¡œìš° ì·¨ì†Œ</p>',1),aa=y('<!> <p class="text-gray-600">íŒ”ë¡œìš°</p>',1),ra=(l,t)=>t.report=!0,sa=y('<div class="flex w-full flex-col items-center rounded-lg bg-white"><button class="flex w-full items-center gap-3 p-3"><!></button> <hr class="w-full border-gray-100"> <button class="flex w-full items-center gap-3 p-3"><!></button></div> <button class="mt-4 flex w-full flex-col items-center rounded-lg bg-white"><div class="flex w-full items-center gap-3 p-3"><!> <p class="text-gray-600">ë§í¬ë³µì‚¬</p></div></button> <button class="mt-4 flex w-full flex-col items-center rounded-lg bg-white"><div class="flex w-full items-center gap-2 p-3"><!> <p class="text-red-500">ì‹ ê³ í•˜ê¸°</p></div></button>',1),ia=y('<div class="flex flex-col items-center bg-gray-100 p-4 text-sm font-medium"><!></div>'),na=y('<label class="flex items-center"><input type="radio" name="report_reason" class="radio radio-primary radio-xs"> <span class="ml-2"> </span></label>'),la=y('<div class="p-4"><h2 class="text-lg font-bold">ë¬´ì—‡ì„ ì‹ ê³ í•˜ì‹œë‚˜ìš”?</h2> <p class="mt-1 text-sm text-gray-500">ì»¤ë®¤ë‹ˆí‹° ê°€ì´ë“œë¼ì¸ì— ì–´ê¸‹ë‚˜ëŠ” ë‚´ìš©ì„ ì•Œë ¤ì£¼ì„¸ìš”.</p> <div class="mt-4 space-y-2"></div> <textarea class="textarea textarea-bordered focus:border-primary mt-4 w-full focus:outline-none" placeholder="ìƒì„¸ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”. (ì„ íƒ ì‚¬í•­)" rows="3"></textarea></div> <div class="flex"><button class="btn w-1/3 rounded-none">ì·¨ì†Œ</button> <button class="btn btn-primary w-2/3 rounded-none">ì œì¶œ</button></div>',1),ca=y('<article class="px-4"><div class="flex items-center justify-between"><a class="flex items-center"><img class="mr-2 block aspect-square h-8 w-8 rounded-full object-cover" loading="lazy" decoding="async" width="32" height="32"> <p class="pr-3 text-sm font-medium"> </p> <p class="mt-0.5 text-xs text-gray-400"> </p></a> <!></div> <a class="mt-2 line-clamp-2 font-semibold"> </a> <div><!> <!></div> <div class="mt-3 flex items-center justify-between text-sm text-gray-400"><div class="flex"><button class="mr-3 flex items-center gap-1" aria-label="ì¢‹ì•„ìš”"><!> <p> </p></button> <button class="mr-4 flex items-center gap-1" aria-label="ì‹«ì–´ìš”"><!></button> <a class="mr-4 flex items-center gap-1" aria-label="ëŒ“ê¸€"><!> <p> </p></a> <button class="flex items-center gap-1" aria-label="ì„ ë¬¼í•˜ê¸°"><!></button></div> <button class="flex items-center gap-1"><!></button></div></article> <hr class="mt-2 border-gray-300"> <!> <!> <!>',1);function Ua(l,t){me(t,!0);const[_,b]=Je(),m=()=>Qe(oo,"$page",_),n=[],o=pe(),d=he(),v=["ìŠ¤íŒ¸/ê´‘ê³ ì„± ì½˜í…ì¸ ì…ë‹ˆë‹¤.","ìš•ì„¤/í˜ì˜¤ ë°œì–¸ì„ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.","ì„ ì •ì ì¸ ë‚´ìš©ì„ í¬í•¨í•˜ê³  ìˆìŠµë‹ˆë‹¤.","ì˜ëª»ëœ ì •ë³´ë¥¼ í¬í•¨í•˜ê³  ìˆìŠµë‹ˆë‹¤.","ê¸°íƒ€"],p=/\.(mp4|mov|webm|ogg)$/i,U={LIKE:1,DISLIKE:-1,NEUTRAL:0};let z=dt(Tt(t.post.like_count??0)),h=dt(null),Y=dt(!1),x=dt(!1),ut=dt(!1),M=Tt({post_config:!1,gift:!1,report:!1}),P=Tt({reason:"",details:""});const J=t.post.users?.handle||"unknown",Q=`/@${J}/post/${t.post.id}`,W=pt(()=>typeof window<"u"?`${window.location.origin}${Q}`:"");let at=pt(()=>a(h)!==null?a(h):o?.id&&t.post.post_votes?t.post.post_votes.find(e=>e.user_id===o.id)?.vote??0:0),q=pt(()=>o?.id&&t.post.post_bookmarks?t.post.post_bookmarks.some(e=>e.user_id===o.id):!1),$=pt(()=>m().url.pathname.match(/^\/@[^/]+\/post\/[^/]+$/));qe(async()=>{await Mt()});async function Mt(){o?.id&&(t.post.users?.id&&w(ut,await d.user_follows.is_following(o.id,t.post.users.id),!0),await rt())}async function rt(){try{const e=await d.post_votes.get_user_vote(t.post.id,o.id),c=t.post.post_votes?.find(C=>C.user_id===o.id)?.vote??0;e!==c&&w(h,e,!0)}catch(e){console.error("Failed to sync vote state:",e)}}async function _t(e){if(!Ut(o)||a(Y))return;w(Y,!0);const c=a(at),C=a(z);ht(c,e);try{await d.post_votes.handle_vote(t.post.id,o.id,a(h)),xt(c,a(h))&&await Ht(),t.onVoteChanged?.({post_id:t.post.id,user_vote:a(h),like_count:a(z)})}catch(D){console.error("Vote failed:",D),w(h,c===0?null:c,!0),w(z,C,!0),S("error","íˆ¬í‘œ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}finally{w(Y,!1)}}function ht(e,c){e===c?(w(h,U.NEUTRAL,!0),c===U.LIKE&&Yt(z,-1)):(w(h,c,!0),e===U.LIKE&&Yt(z,-1),c===U.LIKE&&Yt(z))}function xt(e,c){return e!==U.LIKE&&c===U.LIKE&&t.post.users?.id&&t.post.users.id!==o.id}async function Ht(){try{await d.notifications.insert({recipient_id:t.post.users.id,actor_id:o.id,type:"post.liked",resource_type:"post",resource_id:String(t.post.id),payload:{post_id:t.post.id,post_title:t.post.title},link_url:Q})}catch(e){console.error("Failed to send like notification:",e)}}async function tt(){if(!(!Ut(o)||a(x))){w(x,!0);try{a(q)?(await d.post_bookmarks.delete(t.post.id,o.id),t.onBookmarkChanged?.({post_id:t.post.id,action:"remove",user_id:o.id})):(await d.post_bookmarks.insert(t.post.id,o.id),t.onBookmarkChanged?.({post_id:t.post.id,action:"add",user_id:o.id}))}catch(e){console.error("Bookmark toggle failed:",e),S("error","ë¶ë§ˆí¬ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}finally{w(x,!1)}}}async function vt(){if(!(!Ut(o)||!t.post.users?.id))try{a(ut)?(await d.user_follows.unfollow(o.id,t.post.users.id),o.user_follows=o.user_follows.filter(e=>e.following_id!==t.post.users.id)):(await d.user_follows.follow(o.id,t.post.users.id),o.user_follows=[...o.user_follows,{following_id:t.post.users.id}]),w(ut,!a(ut))}catch(e){console.error("Follow toggle failed:",e),S("error","íŒ”ë¡œìš° ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}}async function st(){if(!P.reason){S("error","ì‹ ê³  ì‚¬ìœ ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.");return}try{await d.post_reports.insert({reporter_id:o.id,post_id:t.post.id,reason:P.reason,details:P.details}),S("success","ì‹ ê³ ê°€ ì •ìƒì ìœ¼ë¡œ ì ‘ìˆ˜ë˜ì—ˆìŠµë‹ˆë‹¤."),it()}catch(e){console.error("Failed to submit report:",e),S("error","ì‹ ê³  ì ‘ìˆ˜ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}}function it(){M.report=!1,P.reason="",P.details=""}function nt({gift_content:e,gift_moon_point:c,post_id:C}){t.onGiftCommentAdded?.({gift_content:e,gift_moon_point:c,parent_comment_id:null,post_id:t.post.id}),M.gift=!1}function lt(e){return p.test(e)}function mt(e){return!e||lt(e)?e:e.includes("supabase.co/storage")?`${e}?width=800&quality=75`:e}function Et(){Ut(o)&&(M.post_config=!0)}var ft=ca(),gt=T(ft),bt=s(gt),R=s(bt);O(R,"href",`/@${J}`);var Gt=s(R),Ot=i(Gt,2),we=s(Ot,!0);r(Ot);var Wt=i(Ot,2),ye=s(Wt,!0);r(Wt),r(R);var ke=i(R,2);{var Ce=e=>{var c=le(),C=T(c);{var D=H=>{var E=le(),V=T(E);{var I=f=>{var L=Ko();L.__click=vt,u(f,L)},K=f=>{var L=So();L.__click=vt,u(f,L)};B(V,f=>{a(ut)?f(I):f(K,!1)})}u(H,E)};B(C,H=>{t.post.users?.id&&t.post.users.id!==o.id&&H(D)})}u(e,c)},Le=e=>{var c=jo();c.__click=Et;var C=s(c);Pt(C,{attribute:"ellipsis",size:20,get color(){return k.gray[500]}}),r(c),u(e,c)};B(ke,e=>{m().params.post_id?e(Ce):e(Le,!1)})}r(bt);var Bt=i(bt,2);O(Bt,"href",Q);var ze=s(Bt,!0);r(Bt);var qt=i(Bt,2),$t=s(qt);{var Ve=e=>{var c=No(),C=T(c);{var D=V=>{var I=To(),K=s(I);{var f=Z=>{var F=Fo();j(()=>O(F,"src",t.post.images[0].uri)),u(Z,F)},L=Z=>{const F=pt(()=>t.post.images.map(et=>mt(et.uri)));de(Z,{get images(){return a(F)}})};B(K,Z=>{lt(t.post.images[0].uri)?Z(f):Z(L,!1)})}r(I),u(V,I)};B(C,V=>{t.post.images?.length>0&&V(D)})}var H=i(C,2),E=s(H);ce(E,()=>t.post.content),r(H),u(e,c)},Me=(e,c)=>{{var C=H=>{var E=Go(),V=s(E);{var I=f=>{var L=Do();j(()=>O(L,"src",t.post.images[0].uri)),u(f,L)},K=f=>{const L=pt(()=>t.post.images.map(Z=>mt(Z.uri)));de(f,{get images(){return a(L)}})};B(V,f=>{lt(t.post.images[0].uri)?f(I):f(K,!1)})}r(E),u(H,E)},D=H=>{var E=Ao();E.__click=[Oo,Q],E.__keydown=[qo,Q];var V=s(E),I=s(V);ce(I,()=>t.post.content),X(2),r(V),r(E),u(H,E)};B(e,H=>{t.post.images?.length>0?H(C):H(D,!1)},c)}};B($t,e=>{a($)?e(Ve):e(Me,!1)})}var He=i($t,2);{var Ee=e=>{var c=Xo(),C=s(c,!0);r(c),j(()=>{O(c,"href",`/community/${t.post.communities.slug}`),ot(C,t.post.communities.title)}),u(e,c)};B(He,e=>{t.post.community_id&&e(Ee)})}r(qt);var te=i(qt,2),At=s(te),Kt=s(At);Kt.__click=[Yo,_t,U];var ee=s(Kt);{var Re=e=>{_o(e,{size:16,get color(){return k.primary}})},Ie=e=>{mo(e,{size:16,get color(){return k.gray[400]}})};B(ee,e=>{a(at)===U.LIKE?e(Re):e(Ie,!1)})}var oe=i(ee,2),Ze=s(oe,!0);r(oe),r(Kt);var St=i(Kt,2);St.__click=[Jo,_t,U];var Pe=s(St);{var Ue=e=>{no(e,{size:16,get color(){return k.warning}})},Be=e=>{co(e,{size:16,get color(){return k.gray[400]}})};B(Pe,e=>{a(at)===U.DISLIKE?e(Ue):e(Be,!1)})}r(St);var jt=i(St,2);O(jt,"href",Q);var ae=s(jt);Pt(ae,{attribute:"chat_bubble",size:16,get color(){return k.gray[400]}});var re=i(ae,2),Ke=s(re,!0);r(re),r(jt);var Xt=i(jt,2);Xt.__click=()=>{Ut(o)&&(M.gift=!0)};var Se=s(Xt);Pt(Se,{attribute:"gift",size:16,get color(){return k.gray[400]}}),r(Xt),r(At);var Ft=i(At,2);Ft.__click=tt;var je=s(Ft);{var Fe=e=>{Qt(e,{size:16,get color(){return k.primary}})},Te=e=>{Jt(e,{size:16,get color(){return k.gray[400]}})};B(je,e=>{a(q)?e(Fe):e(Te,!1)})}r(Ft),r(te),r(gt);var se=i(gt,4);Dt(se,{modal_position:"bottom",get is_modal_open(){return M.post_config},set is_modal_open(e){M.post_config=e},children:(e,c)=>{var C=ia(),D=s(C);{var H=V=>{var I=$o(),K=T(I),f=s(K),L=s(f);ao(L,{size:20,get color(){return k.gray[400]}}),X(2),r(f);var Z=i(f,4);Z.__click=tt;var F=s(Z);{var et=ct=>{var yt=Qo(),kt=T(yt);Qt(kt,{size:20,get color(){return k.primary}}),X(2),u(ct,yt)},Rt=ct=>{var yt=Wo(),kt=T(yt);Jt(kt,{size:20,get color(){return k.gray[400]}}),X(2),u(ct,yt)};B(F,ct=>{a(q)?ct(et):ct(Rt,!1)})}r(Z),r(K);var wt=i(K,2);wt.__click=[ve,W];var It=s(wt),Zt=s(It);Pt(Zt,{attribute:"link",size:20,get color(){return k.gray[600]}}),X(2),r(It),r(wt),j(()=>O(f,"href",`/regi/post/${t.post.id}`)),u(V,I)},E=V=>{var I=sa(),K=T(I),f=s(K);f.__click=tt;var L=s(f);{var Z=G=>{var A=ta(),Ct=T(A);Qt(Ct,{size:20,get color(){return k.primary}}),X(2),u(G,A)},F=G=>{var A=ea(),Ct=T(A);Jt(Ct,{size:20,get color(){return k.gray[600]}}),X(2),u(G,A)};B(L,G=>{a(q)?G(Z):G(F,!1)})}r(f);var et=i(f,4);et.__click=vt;var Rt=s(et);{var wt=G=>{var A=oa(),Ct=T(A);po(Ct,{size:20,get color(){return k.gray[600]}}),X(2),u(G,A)},It=G=>{var A=aa(),Ct=T(A);go(Ct,{size:20,get color(){return k.gray[600]}}),X(2),u(G,A)};B(Rt,G=>{a(ut)?G(wt):G(It,!1)})}r(et),r(K);var Zt=i(K,2);Zt.__click=[ve,W];var ct=s(Zt),yt=s(ct);Pt(yt,{attribute:"link",size:20,get color(){return k.gray[600]}}),X(2),r(ct),r(Zt);var kt=i(Zt,2);kt.__click=[ra,M];var ne=s(kt),Oe=s(ne);Pt(Oe,{attribute:"exclamation",size:24,get color(){return k.warning}}),X(2),r(ne),r(kt),u(V,I)};B(D,V=>{t.post.users?.id===o.id?V(H):V(E,!1)})}r(C),u(e,C)},$$slots:{default:!0}});var ie=i(se,2);Dt(ie,{modal_position:"center",get is_modal_open(){return M.report},set is_modal_open(e){M.report=e},children:(e,c)=>{var C=la(),D=T(C),H=i(s(D),4);Ae(H,21,()=>v,Xe,(f,L)=>{var Z=na(),F=s(Z);Nt(F);var et,Rt=i(F,2),wt=s(Rt,!0);r(Rt),r(Z),j(()=>{et!==(et=a(L))&&(F.value=(F.__value=a(L))??""),ot(wt,a(L))}),Ye(n,[],F,()=>(a(L),P.reason),It=>P.reason=It),u(f,Z)}),r(H);var E=i(H,2);be(E),r(D);var V=i(D,2),I=s(V);I.__click=it;var K=i(I,2);K.__click=st,r(V),Lt(E,()=>P.details,f=>P.details=f),u(e,C)},$$slots:{default:!0}});var Ne=i(ie,2);const De=pt(()=>t.post.users?.id),Ge=pt(()=>t.post.users?.name||"Unknown User");Bo(Ne,{get receiver_id(){return a(De)},get receiver_name(){return a(Ge)},get post_id(){return t.post.id},onGiftSuccess:nt,get is_modal_open(){return M.gift},set is_modal_open(e){M.gift=e}}),j((e,c)=>{O(Gt,"src",e),O(Gt,"alt",`${(t.post.users?.name||"Unknown User")??""}ë‹˜ì˜ í”„ë¡œí•„ ì‚¬ì§„`),ot(we,t.post.users?.name||"Unknown User"),ot(ye,c),ot(ze,t.post.title),ot(Ze,a(z)),ot(Ke,t.post.post_comments?.[0]?.count??0),O(Ft,"aria-label",a(q)?"ë¶ë§ˆí¬ í•´ì œ":"ë¶ë§ˆí¬")},[()=>ro(t.post.users?.avatar_url)??We,()=>to(t.post.created_at)]),u(l,ft),fe(),b()}ge(["click","keydown"]);export{Bo as G,Ua as P,_o as R,mo as a,no as b,Pa as c,co as d,Qt as e,po as f,go as g};
