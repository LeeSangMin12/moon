import"../chunks/CWj6FrbW.js";import{i as ne,s as E,j as ge,t as y,m as c,f as ve,l as o,n as e,r as n,u as X,g as m,k as oe,o as x,ap as fe,x as xe,w as _e,v as ye,$ as Se}from"../chunks/BxrbYPPH.js";import{o as je,s as te}from"../chunks/BpDpeONt.js";import{i as B}from"../chunks/C_-0o-f2.js";import{d as le,e as Re,h as Ae}from"../chunks/DKpueC4a.js";import{r as ae,f as Be,a as me,b as he,c as De}from"../chunks/BGk8CD_Q.js";import{t as be}from"../chunks/Dk6PeW0B.js";import{c as Ee}from"../chunks/Dcrl4MPd.js";import{a as pe,p as Te,g as Ue}from"../chunks/C6eE29Wt.js";import{s as L,u as ce}from"../chunks/iREZRceN.js";import{g as Ve}from"../chunks/DOeRUQ82.js";import"../chunks/69_IOA4Y.js";import{R as Ze}from"../chunks/DgJjuvVc.js";import{s as Ie,f as Oe}from"../chunks/B1FdZY2a.js";import{H as ze}from"../chunks/BezDMT-k.js";import{M as Fe}from"../chunks/IkWuq9-R.js";import{e as Xe,i as qe}from"../chunks/n-s4RcA1.js";import{b as ie}from"../chunks/vV7d1D-f.js";import{b as Ge}from"../chunks/DUXZVHcJ.js";import{p as re}from"../chunks/Cqu1rs7T.js";import{P as Je}from"../chunks/bafqjiaL.js";import{i as we}from"../chunks/Bb3yvuEN.js";const Ke=(h,t,r,_)=>{const l=t(h.target.value);r(l),_(r())};var Ne=y('<span class="loading loading-spinner loading-sm"></span>'),Qe=y('<p class="mt-1 text-sm text-red-500"> </p>'),We=y('<input type="text" inputmode="numeric" maxlength="1" class="input input-bordered focus:border-primary h-14 w-12 text-center text-lg font-semibold focus:outline-none">'),Ye=y('<span class="loading loading-spinner loading-sm"></span> ì¸ì¦ í™•ì¸ ì¤‘...',1),et=y('<p class="mt-2 text-center text-sm text-gray-600"> </p>'),tt=y('<div class="mx-4 mt-8"><p class="ml-1 font-semibold">ì¸ì¦ë²ˆí˜¸</p> <p class="ml-1 mt-1 text-sm text-gray-600"> </p> <div class="mt-4 flex justify-center gap-2"></div> <div class="mt-6 flex flex-col items-center gap-2"><button class="btn btn-primary w-full"><!></button> <button class="btn btn-ghost btn-sm"> </button></div> <!></div>'),at=y('<div class="mx-4 mt-4 rounded-lg bg-blue-50 p-4"><p class="text-sm text-blue-800">ğŸ“± ë³¸ì¸ í™•ì¸ì„ ìœ„í•´ ì „í™”ë²ˆí˜¸ ì¸ì¦ì´ í•„ìš”í•´ìš”</p></div> <div class="mx-4 mt-8"><p class="ml-1 font-semibold">ì „í™”ë²ˆí˜¸</p> <div class="mt-2 flex gap-2"><input type="tel" placeholder="010-1234-5678" maxlength="13" class="input input-bordered focus:border-primary h-[52px] flex-1 focus:outline-none disabled:bg-gray-100"> <button class="btn btn-primary h-[52px] min-w-[100px] whitespace-nowrap px-4"><!></button></div> <!></div> <!>',1);function rt(h,t){ne(t,!0);let r=re(t,"phone",15,"");const _=pe();let l=E(ge(["","","","","",""])),p=E(!1),v=E(0),a=E(!1),w=E(!1),b=E(""),$=E(0);const D=5;let H=[];const T=s=>{const i=s.replace(/-/g,""),u=/^010\d{8}$/;return s?u.test(i)?(x(b,""),!0):(x(b,"ì˜¬ë°”ë¥¸ ì „í™”ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš” (ì˜ˆ: 010-1234-5678)"),!1):(x(b,""),!1)},S=s=>{const i=s.replace(/[^0-9]/g,"");return i.length<=3?i:i.length<=7?`${i.slice(0,3)}-${i.slice(3)}`:`${i.slice(0,3)}-${i.slice(3,7)}-${i.slice(7,11)}`},M=async()=>{if(!T(r())){L("error","ì˜¬ë°”ë¥¸ ì „í™”ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”");return}try{x(a,!0);const s=_.auth.format_to_international(r());if(await _.auth.check_phone_exists(s)){L("error","ì´ë¯¸ ê°€ì…ëœ ì „í™”ë²ˆí˜¸ì…ë‹ˆë‹¤");return}await _.auth.send_otp(s),x(p,!0),G(),L("success","ì¸ì¦ë²ˆí˜¸ê°€ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤"),setTimeout(()=>{H[0]?.focus()},100)}catch(s){console.error("OTP ì „ì†¡ ì‹¤íŒ¨:",s),L("error","ì¸ì¦ë²ˆí˜¸ ì „ì†¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤")}finally{x(a,!1)}},I=async()=>{const s=e(l).join("");if(s.length!==6){L("error","ì¸ì¦ë²ˆí˜¸ 6ìë¦¬ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”");return}if(e($)>=D){L("error","ì¸ì¦ ì‹œë„ íšŸìˆ˜ë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”");return}try{x(w,!0);const i=_.auth.format_to_international(r()),u=await _.auth.verify_otp(i,s);L("success","ì „í™”ë²ˆí˜¸ ì¸ì¦ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤"),t.on_verified?.(u,i)}catch(i){console.error("OTP ê²€ì¦ ì‹¤íŒ¨:",i),fe($),L("error","ì¸ì¦ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤"),x(l,["","","","","",""],!0),setTimeout(()=>{H[0]?.focus()},100)}finally{x(w,!1)}},G=()=>{x(v,180);const s=setInterval(()=>{fe(v,-1),e(v)<=0&&clearInterval(s)},1e3)},O=(s,i)=>{const u=i.target.value;if(u&&!/^\d$/.test(u)){i.target.value="";return}e(l)[s]=u,u&&s<5&&H[s+1]?.focus(),s===5&&u&&I()},Q=(s,i)=>{i.key==="Backspace"&&!e(l)[s]&&s>0&&H[s-1]?.focus()},se=s=>{s.preventDefault();const u=s.clipboardData.getData("text").replace(/\D/g,"").slice(0,6).split("");u.forEach((k,A)=>{A<6&&(e(l)[A]=k)});const K=Math.min(u.length,5);H[K]?.focus(),u.length===6&&I()},f=xe(()=>()=>{const s=Math.floor(e(v)/60),i=e(v)%60;return`${s}:${i.toString().padStart(2,"0")}`});je(()=>()=>{});var U=at(),W=c(ve(U),2),q=c(o(W),2),J=o(q);ae(J),J.__input=[Ke,S,r,T];var Y=c(J,2);Y.__click=M;var d=o(Y);{var P=s=>{var i=Ne();m(s,i)},g=(s,i)=>{{var u=k=>{var A=_e();X(z=>te(A,z),[()=>e(f)()]),m(k,A)},K=k=>{var A=_e("ì¸ì¦ë²ˆí˜¸");m(k,A)};B(s,k=>{e(v)>0?k(u):k(K,!1)},i)}};B(d,s=>{e(a)?s(P):s(g,!1)})}n(Y),n(q);var Z=c(q,2);{var j=s=>{var i=Qe(),u=o(i,!0);n(i),X(()=>te(u,e(b))),m(s,i)};B(Z,s=>{e(b)&&s(j)})}n(W);var R=c(W,2);{var ue=s=>{var i=tt(),u=c(o(i),2),K=o(u);n(u);var k=c(u,2);Xe(k,21,()=>e(l),qe,(C,V,ee)=>{var N=We();ae(N),N.__input=F=>O(ee,F),N.__keydown=F=>Q(ee,F),Ge(N,(F,Pe)=>H[Pe]=F,F=>H?.[F],()=>[ee]),X(()=>Be(N,e(V))),Re("paste",N,function(...F){(ee===0?se:void 0)?.apply(this,F)}),m(C,N)}),n(k);var A=c(k,2),z=o(A);z.__click=I;var ke=o(z);{var Ce=C=>{var V=Ye();ye(),m(C,V)},$e=C=>{var V=_e("ì¸ì¦ í™•ì¸");m(C,V)};B(ke,C=>{e(w)?C(Ce):C($e,!1)})}n(z);var de=c(z,2);de.__click=M;var He=o(de,!0);n(de),n(A);var Le=c(A,2);{var Me=C=>{var V=et(),ee=o(V);n(V),X(()=>te(ee,`${D-e($)}íšŒ ë‚¨ì•˜ìŠµë‹ˆë‹¤`)),m(C,V)};B(Le,C=>{e($)>0&&C(Me)})}n(i),X((C,V)=>{te(K,`${r()??""}ë¡œ ì „ì†¡ëœ 6ìë¦¬ ì¸ì¦ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”`),z.disabled=C,de.disabled=e(v)>0||e(a),te(He,V)},[()=>e(l).some(C=>!C)||e(w),()=>e(v)>0?`ì¬ì „ì†¡ (${e(f)()})`:"ì¸ì¦ë²ˆí˜¸ ì¬ì „ì†¡"]),m(s,i)};B(R,s=>{e(p)&&s(ue)})}X(()=>{J.disabled=e(p),Y.disabled=!r()||!!e(b)||e(v)>0||e(a)}),ie(J,r),m(h,U),oe()}le(["input","click","keydown"]);const st=async(h,t,r,_)=>{if(!t.user_id){L("error","ì‚¬ìš©ì ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤");return}ce("loading",!0);try{const l=h.target.files[0];if(!l)return;l.uri=URL.createObjectURL(l);const p=l.name.split(".").pop(),v=`avatars/${t.user_id}/${Date.now()}.${p}`;await r.user_avatars.upload(v,l);const a=`${Je}/storage/v1/object/public/users/${v}`;await r.users.update(t.user_id,{avatar_url:a}),_(a),L("success","í”„ë¡œí•„ ì‚¬ì§„ì´ ì—…ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤")}catch(l){console.error("í”„ë¡œí•„ ì‚¬ì§„ ì—…ë¡œë“œ ì‹¤íŒ¨:",l),L("error","í”„ë¡œí•„ ì‚¬ì§„ ì—…ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤")}finally{ce("loading",!1)}};var it=y('<img alt="ì‚¬ìš©ì í”„ë¡œí•„ ì‚¬ì§„" loading="eager" width="96" height="96">'),nt=y('<img alt="ê¸°ë³¸ ì‚¬ìš©ì í”„ë¡œí•„ ì‚¬ì§„" loading="eager" width="96" height="96">'),ot=y('<div class="mx-4 mt-8"><p class="ml-1 font-semibold">í”„ë¡œí•„ ì‚¬ì§„ ì¶”ê°€ (ì„ íƒ)</p> <div class="mt-10 flex justify-center"><div class="flex items-center justify-center"><label for="input-file"><input type="file" id="input-file" accept="image/*," multiple class="hidden"> <div class="avatar relative"><div class="w-24 rounded-full"><!></div> <svg class="absolute right-0 bottom-0" width="28" height="29" viewBox="0 0 30 31" fill="none" xmlns="http://www.w3.org/2000/svg"><rect y="0.808594" width="30" height="30" rx="15" fill="#237BF8"></rect><path d="M16.484 11.1419L17.765 12.4753H20.6V20.4753H9.4V12.4753H12.235L13.516 11.1419H16.484ZM17.1 9.80859H12.9L11.619 11.1419H9.4C8.63 11.1419 8 11.7419 8 12.4753V20.4753C8 21.2086 8.63 21.8086 9.4 21.8086H20.6C21.37 21.8086 22 21.2086 22 20.4753V12.4753C22 11.7419 21.37 11.1419 20.6 11.1419H18.381L17.1 9.80859ZM15 14.4753C16.155 14.4753 17.1 15.3753 17.1 16.4753C17.1 17.5753 16.155 18.4753 15 18.4753C13.845 18.4753 12.9 17.5753 12.9 16.4753C12.9 15.3753 13.845 14.4753 15 14.4753ZM15 13.1419C13.068 13.1419 11.5 14.6353 11.5 16.4753C11.5 18.3153 13.068 19.8086 15 19.8086C16.932 19.8086 18.5 18.3153 18.5 16.4753C18.5 14.6353 16.932 13.1419 15 13.1419Z" fill="white"></path></svg></div></label></div></div></div>');function lt(h,t){ne(t,!0);const r=pe();let _=re(t,"avatar_url",15,"");var l=ot(),p=c(o(l),2),v=o(p),a=o(v),w=o(a);w.__change=[st,t,r,_];var b=c(w,2),$=o(b),D=o($);{var H=S=>{var M=it();X(()=>me(M,"src",_())),m(S,M)},T=S=>{var M=nt();me(M,"src",Te),m(S,M)};B(D,S=>{_()?S(H):S(T,!1)})}n($),ye(2),n(b),n(a),n(v),n(p),n(l),m(h,l),oe()}le(["change"]);var dt=(h,t,r)=>t(r().handle),ct=y('<p class="mt-1 text-sm text-red-500">ì•„ì´ë””ì—ëŠ” ì˜ì–´, ìˆ«ì, ë°‘ì¤„(_), ë§ˆì¹¨í‘œ(.)ë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>'),vt=(h,t,r)=>t(r().email),ut=y('<p class="mt-1 text-sm text-red-500">ì˜¬ë°”ë¥¸ ì´ë©”ì¼ ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.</p>'),_t=y('<div class="mx-4 mt-8"><p class="ml-1 font-semibold">ì´ë¦„</p> <div class="mt-2"><input type="text" placeholder="ì˜ˆ: í™ê¸¸ë™" class="input input-bordered focus:border-primary h-[52px] w-full focus:outline-none"></div></div> <div class="mx-4 mt-8"><p class="ml-1 font-semibold">ì•„ì´ë””</p> <div class="mt-2"><input type="text" placeholder="ì˜ˆ: devsangmin32" class="input input-bordered focus:border-primary h-[52px] w-full focus:outline-none"></div> <!></div> <div class="mx-4 mt-8"><p class="ml-1 font-semibold">ì´ë©”ì¼</p> <div class="mt-2"><input type="email" placeholder="ì˜ˆ: example@email.com" class="input input-bordered focus:border-primary h-[52px] w-full focus:outline-none"></div> <!></div>',1);function pt(h,t){ne(t,!1);let r=re(t,"data",12),_=re(t,"handle_error",12),l=re(t,"email_error",12);const p=f=>{/^[a-zA-Z0-9._]+$/.test(f)?_(!1):_(!0)},v=f=>{/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(f)?l(!1):l(!0)};we();var a=_t(),w=ve(a),b=c(o(w),2),$=o(b);ae($),n(b),n(w);var D=c(w,2),H=c(o(D),2),T=o(H);ae(T),T.__input=[dt,p,r],n(H);var S=c(H,2);{var M=f=>{var U=ct();m(f,U)};B(S,f=>{_()&&f(M)})}n(D);var I=c(D,2),G=c(o(I),2),O=o(G);ae(O),O.__input=[vt,v,r],n(G);var Q=c(G,2);{var se=f=>{var U=ut();m(f,U)};B(Q,f=>{l()&&f(se)})}n(I),ie($,()=>r().name,f=>r(r().name=f,!0)),ie(T,()=>r().handle,f=>r(r().handle=f,!0)),ie(O,()=>r().email,f=>r(r().email=f,!0)),m(h,a),oe()}le(["input"]);var ft=(h,t)=>t(t().gender=t().gender==="ë‚¨ì"?"":"ë‚¨ì",!0),mt=(h,t)=>t(t().gender=t().gender==="ì—¬ì"?"":"ì—¬ì",!0),ht=y('<div class="mx-4 mt-8"><p class="ml-1 font-semibold">ì„±ë³„</p> <div class="mt-2 flex gap-4"><button>ë‚¨ì</button> <button>ì—¬ì</button></div></div> <div class="mx-4 mt-8"><p class="ml-1 font-semibold">ìƒë…„ì›”ì¼</p> <div class="mt-2"><input type="date" class="input input-bordered focus:border-primary h-[52px] w-full focus:outline-none"></div></div>',1);function bt(h,t){ne(t,!1);let r=re(t,"data",12);we();var _=ht(),l=ve(_),p=c(o(l),2),v=o(p);v.__click=[ft,r];var a=c(v,2);a.__click=[mt,r],n(p),n(l);var w=c(l,2),b=c(o(w),2),$=o(b);ae($),n(b),n(w),X(()=>{he(v,1,`btn   border-none ${r().gender==="ë‚¨ì"?"btn-primary":"bg-gray-100"}`),he(a,1,`btn border-none ${r().gender==="ì—¬ì"?"btn-primary":"bg-gray-100"}`)}),ie($,()=>r().birth_date,D=>r(r().birth_date=D,!0)),m(h,_),oe()}le(["click"]);const gt=(h,t,r)=>{e(t)===1?x(r,!0):x(t,e(t)-1)},xt=async(h,t,r,_,l)=>{if(e(t)===1){if(!e(r).phone_verified){L("error","ì „í™”ë²ˆí˜¸ ì¸ì¦ì„ ì™„ë£Œí•´ì£¼ì„¸ìš”");return}}else if(e(t)===2){if(await _.users.check_handle_exists(e(r).handle)){L("error","ì¤‘ë³µëœ ì‚¬ìš©ì ì´ë¦„ì…ë‹ˆë‹¤.");return}}else e(t)===4&&await l();x(t,e(t)+1)};var yt=y('<meta name="description" content="ë¬¸ì— ê°€ì…í•˜ê³  ì „ë¬¸ê°€ë“¤ê³¼ ì†Œí†µí•˜ì„¸ìš”. ê°„ë‹¨í•œ íšŒì›ê°€ì…ìœ¼ë¡œ ì§€ì‹ ê³µìœ  í”Œë«í¼ì„ ì‹œì‘í•˜ì„¸ìš”.">'),wt=y('<button slot="left" class="flex items-center"><!></button>'),kt=y('<h1 slot="center" class="font-semibold"></h1>'),Ct=(h,t)=>x(t,!1),$t=()=>{location.href="/"},Ht=y('<div><div class="flex flex-col items-center justify-center py-10 font-semibold"><p>ë‹¤ìŒì— ê°€ì… í•˜ì‹œê² ì–´ìš”?</p></div> <div class="flex"><button class="btn w-1/3 rounded-none">ë‹«ê¸°</button> <button class="btn btn-error w-2/3 rounded-none text-white">ë‹¤ìŒì— í• ê²Œìš”</button></div></div>'),Lt=y('<!> <div class="mb-4"><div class="h-1 w-full rounded-full bg-gray-200"><div class="h-1 rounded-lg bg-blue-600 transition-all duration-300"></div></div></div> <main><!> <div class="fixed bottom-0 w-full max-w-screen-md bg-white p-4"><div class="pb-safe"><button class="btn btn-primary w-full"> </button></div></div></main> <!>',1);function Nt(h,t){ne(t,!0);const{me:r,update:_}=Ue(),l=pe();let p=E(1),v=E(!1),a=E(ge({phone:"",phone_verified:!1,session:null,gender:"",handle:"",name:"",email:"",birth_date:"",avatar_url:""})),w=E(!1),b=E(!1);const $=(d,P)=>{e(a).phone_verified=!0,e(a).session=d,e(a).phone=P},D=()=>{const{phone_verified:d,name:P,handle:g,email:Z,gender:j,birth_date:R}=e(a);switch(e(p)){case 1:return!d;case 2:return P===""||g===""||Z===""||e(w)===!0||e(b)===!0;case 3:return j===""||R==="";default:return!1}},H=async()=>{ce("loading",!0);try{const d=e(a).session?.user?.id;if(!d)throw new Error("ì„¸ì…˜ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤");await l.users.update(d,{phone:e(a).phone,name:e(a).name,handle:e(a).handle,email:e(a).email,gender:e(a).gender,birth_date:e(a).birth_date}),_({id:d,phone:e(a).phone,name:e(a).name,handle:e(a).handle,email:e(a).email,gender:e(a).gender,birth_date:e(a).birth_date,avatar_url:e(a).avatar_url}),L("success","ê°€ì…ì´ ì™„ë£Œë˜ì—ˆì–´ìš”!"),Ve("/")}catch(d){console.error("íšŒì›ê°€ì… ì €ì¥ ì‹¤íŒ¨:",d),L("error","íšŒì›ê°€ì…ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤")}finally{ce("loading",!1)}};var T=Lt();Ae(d=>{var P=yt();Se.title="íšŒì›ê°€ì… | ë¬¸",m(d,P)});var S=ve(T);ze(S,{$$slots:{left:(d,P)=>{var g=wt();g.__click=[gt,p,v];var Z=o(g);Ze(Z,{size:24,get color(){return Ee.gray[600]}}),n(g),m(d,g)},center:(d,P)=>{var g=kt();g.textContent="íšŒì›ê°€ì…",m(d,g)}}});var M=c(S,2),I=o(M),G=o(I);n(I),n(M);var O=c(M,2),Q=o(O);{var se=d=>{rt(d,{on_verified:$,get phone(){return e(a).phone},set phone(P){e(a).phone=P}})},f=(d,P)=>{{var g=j=>{pt(j,{get data(){return e(a)},set data(R){x(a,R,!0)},get handle_error(){return e(w)},set handle_error(R){x(w,R,!0)},get email_error(){return e(b)},set email_error(R){x(b,R,!0)}})},Z=(j,R)=>{{var ue=i=>{bt(i,{get data(){return e(a)},set data(u){x(a,u,!0)}})},s=(i,u)=>{{var K=k=>{const A=xe(()=>e(a).session?.user?.id);lt(k,{get user_id(){return e(A)},get avatar_url(){return e(a).avatar_url},set avatar_url(z){e(a).avatar_url=z}})};B(i,k=>{e(p)===4&&k(K)},u)}};B(j,i=>{e(p)===3?i(ue):i(s,!1)},R)}};B(d,j=>{e(p)===2?j(g):j(Z,!1)},P)}};B(Q,d=>{e(p)===1?d(se):d(f,!1)})}var U=c(Q,2),W=o(U),q=o(W);q.__click=[xt,p,a,l,H];var J=o(q,!0);n(q),n(W),n(U),n(O);var Y=c(O,2);Fe(Y,{modal_position:"center",get is_modal_open(){return e(v)},set is_modal_open(d){x(v,d,!0)},children:(d,P)=>{var g=Ht(),Z=c(o(g),2),j=o(Z);j.__click=[Ct,v];var R=c(j,2);R.__click=[$t],n(Z),n(g),be(1,g,()=>Ie,()=>({duration:200,start:.95})),be(2,g,()=>Oe,()=>({duration:150})),m(d,g)},$$slots:{default:!0}}),X(d=>{De(G,`width: ${e(p)*(100/4)}%`),q.disabled=d,te(J,e(p)===4?"ì‹œì‘í•˜ê¸°":"ë‹¤ìŒ")},[D]),m(h,T),oe()}le(["click"]);export{Nt as component};
