import"../chunks/CWj6FrbW.js";import{i as Ut,s as z,j as At,t as f,f as G,o as u,m as i,u as P,g as v,k as Ft,l as s,n as e,x as H,$ as St,r as o,v as dt,e as Bt,ap as vt}from"../chunks/BxrbYPPH.js";import{s as U}from"../chunks/BpDpeONt.js";import{i as X}from"../chunks/C_-0o-f2.js";import{e as Y,i as Et}from"../chunks/n-s4RcA1.js";import{d as Gt,h as Ht,r as It}from"../chunks/DKpueC4a.js";import{a as p,r as Mt}from"../chunks/BGk8CD_Q.js";import{b as Ot,a as qt}from"../chunks/vV7d1D-f.js";import{s as Nt}from"../chunks/BqNaFByK.js";import"../chunks/69_IOA4Y.js";import{R as Tt}from"../chunks/DgJjuvVc.js";import{R as Vt}from"../chunks/BjXv7c3i.js";import{R as Dt}from"../chunks/-rDJA651.js";import{H as Jt}from"../chunks/BezDMT-k.js";import{I as pt}from"../chunks/BtboDQMP.js";import{M as Z}from"../chunks/IkWuq9-R.js";import{P as Kt,c as Qt}from"../chunks/Dlgnc5bw.js";import{U as Wt}from"../chunks/CZSApgyP.js";import{o as Xt}from"../chunks/Bxbzq6E6.js";import{l as Yt}from"../chunks/CsDvq0KH.js";import{c as A}from"../chunks/Dcrl4MPd.js";import{b as Zt,c as tt,s as R}from"../chunks/iREZRceN.js";import{g as te,a as ee}from"../chunks/C6eE29Wt.js";const re=async(w,l,x,d,$,F,c)=>{if(!e(l)){R("error","신고 사유를 선택해주세요.");return}try{await x.community_reports.insert({reporter_id:d.id,community_id:e($).id,reason:e(l),details:e(F)}),R("success","신고가 정상적으로 접수되었습니다.")}catch(S){console.error("Failed to submit report:",S),R("error","신고 접수 중 오류가 발생했습니다.")}finally{u(c,!1),u(l,""),u(F,"")}};var ae=f('<meta name="description"> <meta property="og:type" content="website"> <meta property="og:url"> <meta property="og:title"> <meta property="og:description"> <meta property="og:image"> <meta property="og:image:width" content="1200"> <meta property="og:image:height" content="630"> <meta property="twitter:card" content="summary_large_image"> <meta property="twitter:url"> <meta property="twitter:title"> <meta property="twitter:description"> <meta property="twitter:image">',1),oe=f('<div slot="left"><button class="flex items-center" aria-label="뒤로 가기"><!></button></div>'),ie=f('<h1 slot="center" class="text-medium"> </h1>'),se=(w,l,x)=>{tt(l)&&u(x,!0)},ne=f('<div slot="right"><button class="flex items-center" aria-label="메뉴 열기"><!></button></div>'),le=(w,l)=>u(l,!0),ce=(w,l,x,d)=>{tt(l)&&x(e(d).id)},me=f('<button class="btn btn-soft flex flex-1">참여중</button>'),_e=(w,l,x,d)=>{tt(l)&&x(e(d).id)},de=f('<button class="btn btn-primary flex flex-1">참여하기</button>'),ve=()=>Zt(window.location.href,"URL이 복사되었어요!"),pe=f('<div class="mt-4"><!></div>'),ue=f('<a class="flex w-full flex-col items-center rounded-lg bg-white" aria-label="커뮤니티 수정하기"><div class="flex w-full items-center gap-3 p-3"><!> <p class="text-gray-600">수정하기</p></div></a>'),fe=(w,l)=>u(l,!0),ge=f('<button class="w-full rounded-lg bg-white" aria-label="커뮤니티 신고하기"><div class="flex w-full items-center gap-2 p-3"><!> <p class="text-red-500">신고하기</p></div></button>'),be=f('<div class="flex flex-col items-center bg-gray-100 p-4 text-sm font-medium"><!></div>'),ye=f('<label class="flex items-center"><input type="radio" name="report_reason" class="radio radio-primary radio-xs"> <span class="ml-2"> </span></label>'),he=(w,l)=>u(l,!1),xe=f('<div class="p-4"><h2 class="text-lg font-bold">무엇을 신고하시나요?</h2> <p class="mt-1 text-sm text-gray-500">커뮤니티 가이드라인에 어긋나는 내용을 알려주세요.</p> <div class="mt-4 space-y-2"></div> <textarea class="textarea textarea-bordered focus:border-primary mt-4 w-full focus:outline-none" placeholder="상세 내용을 입력해주세요. (선택 사항)" rows="3"></textarea></div> <div class="flex"><button class="btn w-1/3 rounded-none" aria-label="신고 취소">취소</button> <button class="btn btn-primary w-2/3 rounded-none" aria-label="신고 제출">제출</button></div>',1),we=f('<p class="py-8 text-center text-gray-500">아직 유저가 없습니다.</p>'),ke=f('<div class="p-4"><h2 class="mb-4 text-lg font-semibold">참여자</h2> <!></div>'),Pe=f('<!> <main><section class="px-4 py-4"><div class="flex items-start"><div><img class="mr-2 block aspect-square h-14 w-14 rounded-full object-cover" loading="eager" width="56" height="56"></div> <div class="flex-1"><h2 class="font-semibold"> </h2> <button class="mt-1 flex items-center gap-1 text-sm text-gray-400"><!> </button></div></div> <pre class="mt-4 text-sm whitespace-pre-wrap"> </pre> <div class="mt-4 flex space-x-2"><!> <button class="btn btn-soft flex flex-1" aria-label="커뮤니티 링크 공유">공유하기</button></div></section> <hr class="my-2 border-gray-200"> <!></main> <!> <!> <!>',1);function Ke(w,l){Ut(l,!0);const x=[],d=te(),$=ee(),F=["스팸/광고성 콘텐츠입니다.","욕설/혐오 발언을 사용했습니다.","선정적인 내용을 포함하고 있습니다.","잘못된 정보를 포함하고 있습니다.","기타"];let c=H(()=>l.data.community),S=H(()=>l.data.community_participants),L=H(()=>l.data.community_members),B=H(()=>l.data.community.community_members?.[0]?.count??0),I=z(At(l.data.posts)),M=z(!1),O=z(!1),j=z(!1),q=z(""),N=z("");const ut=t=>e(L).some(a=>a.community_id===t.id),ft=async t=>{try{await $.community_members.insert(t,d.id),u(L,[...e(L),{community_id:t,user_id:d.id}],!0),vt(B),R("success","커뮤니티에 참여했어요!")}catch(a){console.error("Failed to join community:",a),R("error","참여 중 오류가 발생했습니다.")}},gt=async t=>{try{await $.community_members.delete(t,d.id),u(L,e(L).filter(a=>a.community_id!==t),!0),vt(B,-1),R("error","커뮤니티 참여가 취소되었어요!")}catch(a){console.error("Failed to leave community:",a),R("error","탈퇴 중 오류가 발생했습니다.")}},bt=async({gift_content:t,gift_moon_point:a,parent_comment_id:r,post_id:n})=>{await $.post_comments.insert({post_id:n,user_id:d.id,content:t,parent_comment_id:r,gift_moon_point:a})},{handle_bookmark_changed:yt,handle_vote_changed:ht}=Qt(()=>e(I),t=>u(I,t,!0),d);var et=Pe();Ht(t=>{var a=ae(),r=G(a),n=i(r,4);p(n,"content",typeof window<"u"?window.location.href:"");var g=i(n,2),h=i(g,2),_=i(h,2),m=i(_,8);p(m,"content",typeof window<"u"?window.location.href:"");var y=i(m,2),b=i(y,2),k=i(b,2);P(()=>{St.title=`${e(c)?.title||"커뮤니티"} | 문`,p(r,"content",e(c)?.content||"다양한 주제와 관심사를 가진 사람들이 모여 소통하는 커뮤니티입니다."),p(g,"content",e(c)?.title||"커뮤니티"),p(h,"content",e(c)?.content||"다양한 주제와 관심사를 가진 사람들이 모여 소통하는 커뮤니티입니다."),p(_,"content",e(c)?.avatar_url||"%sveltekit.assets%/open_graph_img.png"),p(y,"content",e(c)?.title||"커뮤니티"),p(b,"content",e(c)?.content||"다양한 주제와 관심사를 가진 사람들이 모여 소통하는 커뮤니티입니다."),p(k,"content",e(c)?.avatar_url||"%sveltekit.assets%/open_graph_img.png")}),v(t,a)});var rt=G(et);Jt(rt,{$$slots:{left:(t,a)=>{var r=oe(),n=s(r);n.__click=function(...h){Nt?.apply(this,h)};var g=s(n);Tt(g,{size:28,get color(){return A.gray[600]}}),o(n),o(r),v(t,r)},center:(t,a)=>{var r=ie(),n=s(r,!0);o(r),P(()=>U(n,e(c).title)),v(t,r)},right:(t,a)=>{var r=ne(),n=s(r);n.__click=[se,d,O];var g=s(n);pt(g,{attribute:"menu",size:24,get color(){return A.gray[600]}}),o(n),o(r),v(t,r)}}});var T=i(rt,2),V=s(T),D=s(V),J=s(D),at=s(J);o(J);var ot=i(J,2),K=s(ot),xt=s(K,!0);o(K);var E=i(K,2);E.__click=[le,M];var it=s(E);Dt(it,{size:16,get color(){return A.gray[400]}});var wt=i(it);o(E),o(ot),o(D);var Q=i(D,2),kt=s(Q,!0);o(Q);var st=i(Q,2),nt=s(st);{var Pt=t=>{var a=me();a.__click=[ce,d,gt,c],P(()=>p(a,"aria-label",`${e(c).title} 커뮤니티 탈퇴`)),v(t,a)},Rt=t=>{var a=de();a.__click=[_e,d,ft,c],P(()=>p(a,"aria-label",`${e(c).title} 커뮤니티 참여하기`)),v(t,a)};X(nt,t=>{ut(e(c))?t(Pt):t(Rt,!1)})}var $t=i(nt,2);$t.__click=[ve],o(st),o(V);var zt=i(V,4);Y(zt,17,()=>e(I),t=>t.id,(t,a)=>{var r=pe(),n=s(r);Kt(n,{get post(){return e(a)},onGiftCommentAdded:bt,onBookmarkChanged:yt,onVoteChanged:ht}),o(r),v(t,r)}),o(T);var lt=i(T,2);Z(lt,{modal_position:"bottom",get is_modal_open(){return e(O)},set is_modal_open(t){u(O,t,!0)},children:(t,a)=>{var r=be(),n=s(r);{var g=_=>{var m=ue(),y=s(m),b=s(y);Vt(b,{size:20,get color(){return A.gray[600]}}),dt(2),o(y),o(m),P(()=>p(m,"href","/community/regi?slug="+l.data.community.slug)),v(_,m)},h=_=>{var m=ge();m.__click=[fe,j];var y=s(m),b=s(y);pt(b,{attribute:"exclamation",size:24,get color(){return A.warning}}),dt(2),o(y),o(m),v(_,m)};X(n,_=>{e(c).creator_id===d.id?_(g):_(h,!1)})}o(r),v(t,r)},$$slots:{default:!0}});var ct=i(lt,2);Z(ct,{modal_position:"center",get is_modal_open(){return e(j)},set is_modal_open(t){u(j,t,!0)},children:(t,a)=>{var r=xe(),n=G(r),g=i(s(n),4);Y(g,21,()=>F,Et,(b,k)=>{var W=ye(),C=s(W);Mt(C);var mt,_t=i(C,2),jt=s(_t,!0);o(_t),o(W),P(()=>{mt!==(mt=e(k))&&(C.value=(C.__value=e(k))??""),U(jt,e(k))}),qt(x,[],C,()=>(e(k),e(q)),Ct=>u(q,Ct)),v(b,W)}),o(g);var h=i(g,2);It(h),o(n);var _=i(n,2),m=s(_);m.__click=[he,j];var y=i(m,2);y.__click=[re,q,$,d,c,N,j],o(_),Ot(h,()=>e(N),b=>u(N,b)),v(t,r)},$$slots:{default:!0}});var Lt=i(ct,2);Z(Lt,{modal_position:"center",get is_modal_open(){return e(M)},set is_modal_open(t){u(M,t,!0)},children:(t,a)=>{var r=ke(),n=i(s(r),2);{var g=_=>{var m=we();v(_,m)},h=_=>{var m=Bt(),y=G(m);Y(y,17,()=>e(S),b=>b.user_id,(b,k)=>{Wt(b,{get profile(){return e(k).users}})}),v(_,m)};X(n,_=>{e(S).length===0?_(g):_(h,!1)})}o(r),v(t,r)},$$slots:{default:!0}}),P(t=>{p(at,"src",t),p(at,"alt",`${e(c).title} 커뮤니티 아바타`),U(xt,e(c).title),p(E,"aria-label",`참여자 ${e(B)}명 보기`),U(wt,` ${e(B)??""}`),U(kt,e(c).content)},[()=>Xt(e(c).avatar_url)||Yt]),v(w,et),Ft()}Gt(["click"]);export{Ke as component};
