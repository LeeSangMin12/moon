import"../chunks/CWj6FrbW.js";import{i as Jt,j as jt,t as b,f as W,m as r,x as X,s as Y,l as e,u as h,g as c,k as Kt,$ as Mt,n as s,r as a,v as qt,o as _,w as P}from"../chunks/BxrbYPPH.js";import{s as v}from"../chunks/BpDpeONt.js";import{i as E}from"../chunks/C_-0o-f2.js";import{d as Qt,h as Ut}from"../chunks/DKpueC4a.js";import{r as T}from"../chunks/BGk8CD_Q.js";import{b as z}from"../chunks/vV7d1D-f.js";import{c as Vt}from"../chunks/Dcrl4MPd.js";import{g as Wt,a as Xt}from"../chunks/C6eE29Wt.js";import{a as w,b as Yt,c as Zt,u as Et,s as Z}from"../chunks/iREZRceN.js";import{g as Rt}from"../chunks/DOeRUQ82.js";import"../chunks/69_IOA4Y.js";import{R as te}from"../chunks/DgJjuvVc.js";import{H as ee}from"../chunks/BezDMT-k.js";const ae=(R,m,k,u)=>{_(m,null),_(k,""),_(u,"")},re=async(R,m,k,u,S,p,d,l)=>{if(!(!Zt(m)||!s(k))){Et("loading",!0);try{await u.expert_requests.complete_registration_payment(S.id,{depositor_name:p.depositor_name.trim(),bank:p.bank.trim(),account_number:p.account_number.trim()},s(d)?{coupon_id:s(d).id,coupon_discount:s(l)}:null),s(d)&&(await u.user_coupons.insert({user_id:m.id,coupon_id:s(d).id,expert_request_id:S.id,discount_amount:s(l)}),await u.coupons.increment_usage(s(d).id)),Z("success","입금 정보가 제출되었습니다. 관리자 승인 후 공고가 게시됩니다."),Rt(`/expert-request/${S.id}`,{replaceState:!0})}catch(x){console.error("결제 처리 실패:",x),Z("error","결제 처리에 실패했습니다. 다시 시도해주세요.")}finally{Et("loading",!1)}}};var se=()=>Rt("/regi/expert-request"),oe=b('<button slot="left"><!></button>'),ie=b('<h1 slot="center" class="font-semibold">공고 등록 결제</h1>'),ne=b('<div><p class="text-sm text-gray-600">카테고리</p> <p class="mt-1 font-medium text-gray-900"> </p></div>'),le=()=>{Yt("101-2094-2262-04","계좌번호가 복사되었습니다.")},de=b('<div class="flex items-center justify-between text-sm"><span class="text-blue-600">쿠폰 할인</span> <span class="font-medium text-blue-600"> </span></div> <div class="h-px bg-gray-200"></div>',1),ce=(R,m)=>R.key==="Enter"&&m(),ve=b('<p class="mt-2 text-sm text-red-600"> </p>'),ue=b('<div class="flex gap-2"><input type="text" placeholder="쿠폰 코드 입력" class="input input-bordered h-11 flex-1 focus:border-gray-400 focus:outline-none"> <button class="rounded-lg border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50">적용</button></div> <!>',1),me=b('<div class="flex items-center justify-between rounded-lg bg-blue-50 p-3"><div class="flex-1"><p class="font-medium text-blue-900"> </p> <p class="text-sm text-blue-700"><!></p></div> <button class="ml-3 text-sm font-medium text-blue-600 hover:text-blue-800">취소</button></div>'),pe=b('<!> <main class="mx-4 pb-24"><div class="mt-4 rounded-lg border border-gray-200 bg-white p-4"><h2 class="mb-3 text-base font-semibold text-gray-900">등록할 공고</h2> <div class="space-y-2"><div><p class="text-sm text-gray-600">제목</p> <p class="mt-1 font-medium text-gray-900"> </p></div> <!> <div><p class="text-sm text-gray-600">보상금</p> <p class="mt-1 font-medium text-gray-900"> </p></div></div></div> <div class="mt-4 rounded-lg border border-blue-200 bg-blue-50 p-4"><h3 class="mb-2 text-sm font-semibold text-blue-900">공고 등록 안내</h3> <ul class="space-y-1 text-xs text-blue-700"><li> </li> <li>• 등록비 결제 완료 후 공고가 게시됩니다.</li> <li>• 마음에 드는 전문가를 선택하여 프로젝트를 진행하세요.</li></ul></div> <div class="mt-4 rounded-lg border border-gray-200 bg-gray-50 p-4"><h3 class="mb-3 text-sm font-semibold text-gray-900">입금 계좌 안내</h3> <div class="space-y-2 text-sm"><div class="flex items-center justify-between"><div class="flex items-center"><span class="w-16 text-gray-600">은행</span> <span class="font-medium text-gray-900">부산은행</span></div></div> <div class="flex items-center justify-between"><div class="flex items-center"><span class="w-16 text-gray-600">예금주</span> <span class="font-medium text-gray-900">퓨처밴스 이상민</span></div></div> <div class="flex items-center justify-between"><div class="flex items-center"><span class="w-16 text-gray-600">계좌번호</span> <span class="text-primary font-medium">101-2094-2262-04</span></div> <button class="rounded-md border border-gray-300 bg-white px-3 py-1.5 text-xs font-medium text-gray-700 hover:bg-gray-100">복사</button></div> <div class="space-y-2 border-t border-gray-200 pt-2"><div class="flex items-center justify-between text-sm"><span class="text-gray-600">등록비</span> <span class="font-medium text-gray-900"> </span></div> <!> <div class="flex items-center justify-between"><span class="font-semibold text-gray-900">최종 입금 금액</span> <span class="text-lg font-bold text-blue-600"> </span></div></div></div></div> <div class="mt-4 rounded-lg border border-gray-200 bg-white p-4"><h3 class="mb-3 text-sm font-semibold text-gray-900">쿠폰</h3> <!></div> <div class="mt-6"><h2 class="mb-4 text-base font-semibold text-gray-900">입금 정보</h2> <div class="space-y-4"><div><label class="mb-2 block text-sm font-medium text-gray-700">입금자명</label> <input type="text" placeholder="입금자명을 입력해주세요" class="input input-bordered h-12 w-full focus:border-gray-400 focus:outline-none"></div> <div><label class="mb-2 block text-sm font-medium text-gray-700">은행</label> <input type="text" placeholder="은행명을 입력해주세요" class="input input-bordered h-12 w-full focus:border-gray-400 focus:outline-none"></div> <div><label class="mb-2 block text-sm font-medium text-gray-700">계좌번호</label> <input type="text" placeholder="계좌번호를 입력해주세요" class="input input-bordered h-12 w-full focus:border-gray-400 focus:outline-none"></div></div></div></main> <div class="fixed bottom-0 w-full max-w-screen-md border-gray-200 bg-white px-4 py-3"><div class="pb-safe"><button class="btn btn-primary h-12 w-full rounded-lg text-base font-medium disabled:cursor-not-allowed disabled:opacity-50"><!></button></div></div>',1);function Se(R,m){Jt(m,!0);const k=Wt(),u=Xt();let{request:S}=m.data,p=jt(S);const d=4900;let l=jt({depositor_name:"",bank:"",account_number:""}),x=Y(""),f=Y(null),g=Y("");const $=X(()=>s(f)?u.coupons.calculate_discount(s(f),d):0),F=X(()=>d-s($)),tt=X(()=>l.depositor_name.trim()&&l.bank.trim()&&l.account_number.trim()),et=async()=>{if(_(g,""),!s(x).trim()){_(g,"쿠폰 코드를 입력해주세요.");return}const t=await u.coupons.select_by_code(s(x).trim());if(!t){_(g,"존재하지 않는 쿠폰입니다.");return}const o=await u.coupons.validate_coupon(t,k.id,"job_registration",d);if(!o.valid){_(g,o.message,!0);return}_(f,t,!0),Z("success","쿠폰이 적용되었습니다!")};var at=pe();Ut(t=>{Mt.title="공고 등록 결제 | 문"});var rt=W(at);ee(rt,{$$slots:{left:(t,o)=>{var i=oe();i.__click=[se];var n=e(i);te(n,{size:26,get color(){return Vt.gray[600]}}),a(i),c(t,i)},center:(t,o)=>{var i=ie();c(t,i)}}});var G=r(rt,2),N=e(G),st=r(e(N),2),O=e(st),ot=r(e(O),2),St=e(ot,!0);a(ot),a(O);var it=r(O,2);{var At=t=>{var o=ne(),i=r(e(o),2),n=e(i,!0);a(i),a(o),h(()=>v(n,p.category)),c(t,o)};E(it,t=>{p.category&&t(At)})}var nt=r(it,2),lt=r(e(nt),2),Ht=e(lt);a(lt),a(nt),a(st),a(N);var B=r(N,2),dt=r(e(B),2),ct=e(dt),It=e(ct);a(ct),qt(4),a(dt),a(B);var C=r(B,2),vt=r(e(C),2),D=r(e(vt),4),Lt=r(e(D),2);Lt.__click=[le],a(D);var ut=r(D,2),J=e(ut),mt=r(e(J),2),Pt=e(mt);a(mt),a(J);var pt=r(J,2);{var Tt=t=>{var o=de(),i=W(o),n=r(e(i),2),A=e(n);a(n),a(i),qt(2),h(j=>v(A,`-₩${j??""}`),[()=>w(s($))]),c(t,o)};E(pt,t=>{s($)>0&&t(Tt)})}var _t=r(pt,2),bt=r(e(_t),2),zt=e(bt);a(bt),a(_t),a(ut),a(vt),a(C);var K=r(C,2),Ft=r(e(K),2);{var Gt=t=>{var o=ue(),i=W(o),n=e(i);T(n),n.__keydown=[ce,et];var A=r(n,2);A.__click=et,a(i);var j=r(i,2);{var U=y=>{var H=ve(),V=e(H,!0);a(H),h(()=>v(V,s(g))),c(y,H)};E(j,y=>{s(g)&&y(U)})}z(n,()=>s(x),y=>_(x,y)),c(t,o)},Nt=t=>{var o=me(),i=e(o),n=e(i),A=e(n,!0);a(n);var j=r(n,2),U=e(j);{var y=q=>{var L=P("무료 등록");c(q,L)},H=q=>{var L=P();h(Dt=>v(L,`-₩${Dt??""} 할인`),[()=>w(s($))]),c(q,L)};E(U,q=>{s($)>=d?q(y):q(H,!1)})}a(j),a(i);var V=r(i,2);V.__click=[ae,f,x,g],a(o),h(()=>v(A,s(f).name)),c(t,o)};E(Ft,t=>{s(f)?t(Nt,!1):t(Gt)})}a(K);var xt=r(K,2),ft=r(e(xt),2),M=e(ft),gt=r(e(M),2);T(gt),a(M);var Q=r(M,2),yt=r(e(Q),2);T(yt),a(Q);var ht=r(Q,2),wt=r(e(ht),2);T(wt),a(ht),a(ft),a(xt),a(G);var kt=r(G,2),$t=e(kt),I=e($t);I.__click=[re,k,tt,u,p,l,f,$];var Ot=e(I);{var Bt=t=>{var o=P("무료로 등록하기");c(t,o)},Ct=t=>{var o=P();h(i=>v(o,`₩${i??""} 결제하고 등록하기`),[()=>w(s(F))]),c(t,o)};E(Ot,t=>{s(F)===0?t(Bt):t(Ct,!1)})}a(I),a($t),a(kt),h((t,o,i,n)=>{v(St,p.title),v(Ht,`₩${t??""}`),v(It,`• 공고 등록 시 ${o??""}원의 등록비가 발생합니다.`),v(Pt,`₩${i??""}`),v(zt,`₩${n??""}`),I.disabled=!s(tt)},[()=>w(p.reward_amount),()=>w(d),()=>w(d),()=>w(s(F))]),z(gt,()=>l.depositor_name,t=>l.depositor_name=t),z(yt,()=>l.bank,t=>l.bank=t),z(wt,()=>l.account_number,t=>l.account_number=t),c(R,at),Kt()}Qt(["click","keydown"]);export{Se as component};
