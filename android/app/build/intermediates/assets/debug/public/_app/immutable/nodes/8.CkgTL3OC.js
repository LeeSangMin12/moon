import"../chunks/CWj6FrbW.js";import{o as Pe,s as v}from"../chunks/BpDpeONt.js";import{q as Te,u as ve,g as _,i as Ve,s as de,j as xe,t as m,f as De,k as Ee,$ as Ze,l as t,m as o,o as le,n as r,r as e,v as be}from"../chunks/BxrbYPPH.js";import{i as Q}from"../chunks/C_-0o-f2.js";import{e as ye,i as he}from"../chunks/n-s4RcA1.js";import{d as Fe,h as qe}from"../chunks/DKpueC4a.js";import{s as Ae,a as U,b as we}from"../chunks/BGk8CD_Q.js";import{g as $e}from"../chunks/DOeRUQ82.js";import"../chunks/69_IOA4Y.js";import{R as Be}from"../chunks/DgJjuvVc.js";import{R as je}from"../chunks/_EYf95Uz.js";import{l as ke,p as W}from"../chunks/Cqu1rs7T.js";import{R as ze}from"../chunks/BmUo1YTu.js";import{H as Ke}from"../chunks/BezDMT-k.js";import{T as Ge}from"../chunks/DEe1oh43.js";import{c as I}from"../chunks/Dcrl4MPd.js";import{g as Ie,a as Je}from"../chunks/C6eE29Wt.js";import{s as J}from"../chunks/iREZRceN.js";import{o as Ce}from"../chunks/Bxbzq6E6.js";var Ne=Te('<svg><path d="M3 3H21C21.5523 3 22 3.44772 22 4V20C22 20.5523 21.5523 21 21 21H3C2.44772 21 2 20.5523 2 20V4C2 3.44772 2.44772 3 3 3ZM20 7.23792L12.0718 14.338L4 7.21594V19H20V7.23792ZM4.51146 5L12.0619 11.662L19.501 5H4.51146Z"></path></svg>');function Le(y,n){const i=ke(n,["children","$$slots","$$events","$$legacy"]),c=ke(i,["size","color","label","class"]);let h=W(n,"size",8,"1em"),u=W(n,"color",8,"currentColor"),f=W(n,"label",8,""),H=W(n,"class",8,"");var P=Ne();let V;ve(()=>V=Ae(P,V,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:h(),height:h(),fill:u(),"aria-label":f()?f():void 0,"aria-hidden":f()?void 0:"true",role:f()?"img":void 0,class:`remixicon ri-mail-line ${H()??""}`,...c})),_(y,P)}var Oe=m('<meta name="description" content="받은 커피챗과 보낸 커피챗을 확인하고 관리할 수 있습니다.">'),Qe=(y,n)=>$e(`/@${n?.handle}/accounts`),Ue=m('<div slot="left"><button class="flex items-center"><!></button></div>'),We=m('<h1 slot="center" class="font-semibold">커피챗</h1>'),Xe=m('<div class="flex flex-col items-center justify-center py-16 text-center"><div class="mb-4 rounded-full bg-gray-100 p-4"><!></div> <h3 class="mb-2 text-lg font-semibold text-gray-900">아직 받은 커피챗이 없어요</h3> <p class="text-sm text-gray-500">다른 사용자가 커피챗을 요청하면 여기에 표시됩니다.</p></div>'),Ye=(y,n,i)=>n(r(i).sender.handle),et=async(y,n,i,c,h)=>{try{await n.coffee_chats.update_status(r(i).id,"accepted");try{await n.notifications.insert({recipient_id:r(i).sender.id,actor_id:c.id,type:"coffee_chat.accepted",resource_type:"coffee_chat",resource_id:String(r(i).id),payload:{recipient_id:c.id,recipient_name:c.name,recipient_handle:c.handle,subject:r(i).subject},link_url:`/@${c.handle}/accounts/coffee-chat`})}catch(u){console.error("Failed to create acceptance notification:",u)}await h(),J("success","커피챗 요청을 수락했습니다.")}catch{J("error","오류가 발생했습니다.")}},tt=async(y,n,i,c,h)=>{try{await n.coffee_chats.update_status(r(i).id,"rejected");try{await n.notifications.insert({recipient_id:r(i).sender.id,actor_id:c.id,type:"coffee_chat.rejected",resource_type:"coffee_chat",resource_id:String(r(i).id),payload:{recipient_id:c.id,recipient_name:c.name,recipient_handle:c.handle,subject:r(i).subject},link_url:`/@${c.handle}/accounts/coffee-chat`})}catch(u){console.error("Failed to create rejection notification:",u)}await h(),J("success","커피챗 요청을 거절했습니다.")}catch{J("error","오류가 발생했습니다.")}},rt=m('<div class="flex space-x-2"><button class="rounded-lg bg-green-500 px-4 py-2 text-sm font-medium text-white hover:bg-green-600">수락</button> <button class="rounded-lg bg-red-500 px-4 py-2 text-sm font-medium text-white hover:bg-red-600">거절</button></div>'),at=m('<div class="rounded-xl border border-gray-200 bg-white p-5"><div class="mb-4 flex items-center justify-between"><button class="flex items-center space-x-3"><img class="h-10 w-10 rounded-full object-cover" loading="lazy" width="40" height="40"> <div class="text-left"><p class="font-medium text-gray-900"> </p> <p class="text-sm text-gray-500"> </p></div></button> <span> </span></div> <div class="mb-4"><h3 class="mb-2 font-semibold text-gray-900"> </h3> <p class="text-sm leading-relaxed text-gray-600"> </p></div> <div class="mb-4 flex items-center space-x-2 rounded-lg bg-gray-50 p-3"><!> <span class="text-sm text-gray-600"> </span></div> <div class="flex items-center justify-between"><div class="flex items-center space-x-2 text-xs text-gray-500"><!> <span> </span></div> <!></div></div>'),st=m('<div class="space-y-4"></div>'),it=m('<div class="px-4 pb-20"><!></div>'),ot=m('<div class="flex flex-col items-center justify-center py-16 text-center"><div class="mb-4 rounded-full bg-gray-100 p-4"><!></div> <h3 class="mb-2 text-lg font-semibold text-gray-900">아직 보낸 커피챗이 없어요</h3> <p class="text-sm text-gray-500">다른 사용자에게 커피챗을 요청해보세요!</p></div>'),nt=(y,n,i)=>n(r(i).recipient.handle),ct=m('<div class="rounded-xl border border-gray-200 bg-white p-5"><div class="mb-4 flex items-center justify-between"><button class="flex items-center space-x-3"><img class="h-10 w-10 rounded-full object-cover" loading="lazy" width="40" height="40"> <div class="text-left"><p class="font-medium text-gray-900"> </p> <p class="text-sm text-gray-500"> </p></div></button> <span> </span></div> <div class="mb-4"><h3 class="mb-2 font-semibold text-gray-900"> </h3> <p class="text-sm leading-relaxed text-gray-600"> </p></div> <div class="mb-4 flex items-center space-x-2 rounded-lg bg-gray-50 p-3"><!> <span class="text-sm text-gray-600"> </span></div> <div class="flex items-center space-x-2 text-xs text-gray-500"><!> <span> </span></div></div>'),dt=m('<div class="space-y-4"></div>'),lt=m('<div class="px-4 pb-20"><!></div>'),vt=m('<!> <main><div class="px-4 py-4"><!></div> <!></main>',1);function St(y,n){Ve(n,!0);const i=Ie(),c=Je(),h=["받은 커피챗","보낸 커피챗"];let u=de(0),f=de(xe(n.data.received_chats||[])),H=de(xe(n.data.sent_chats||[]));Pe(async()=>{r(f).length===0&&r(H).length===0&&await P()});const P=async()=>{try{if(i?.id){const[s,d]=await Promise.all([c.coffee_chats.select_received(i.id),c.coffee_chats.select_sent(i.id)]);le(f,s,!0),le(H,d,!0)}}catch(s){console.error("Error loading coffee chats:",s),J("error","커피챗을 불러오는데 실패했습니다.")}},V=s=>({pending:"대기중",accepted:"수락됨",rejected:"거절됨"})[s]||s,_e=s=>({pending:"text-yellow-600 bg-yellow-100",accepted:"text-green-600 bg-green-100",rejected:"text-red-600 bg-red-100"})[s]||"text-gray-600 bg-gray-100",pe=s=>new Date(s).toLocaleDateString("ko-KR",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),me=s=>{$e(`/@${s}`)};var ue=vt();qe(s=>{var d=Oe();Ze.title="커피챗 | 문",_(s,d)});var fe=De(ue);Ke(fe,{$$slots:{left:(s,d)=>{var g=Ue(),w=t(g);w.__click=[Qe,i];var D=t(w);Be(D,{size:24,get color(){return I.gray[600]}}),e(w),e(g),_(s,g)},center:(s,d)=>{var g=We();_(s,g)}}});var ge=o(fe,2),X=t(ge),Me=t(X);Ge(Me,{tabs:h,get selected(){return r(u)},set selected(s){le(u,s,!0)}}),e(X);var Re=o(X,2);{var Se=s=>{var d=it(),g=t(d);{var w=p=>{var l=Xe(),x=t(l),a=t(x);je(a,{size:48,get color(){return I.gray[400]}}),e(x),be(4),e(l),_(p,l)},D=p=>{var l=st();ye(l,21,()=>r(f),he,(x,a)=>{var j=at(),k=t(j),b=t(k);b.__click=[Ye,me,a];var z=t(b),E=o(z,2),C=t(E),Y=t(C,!0);e(C);var Z=o(C,2),ee=t(Z);e(Z),e(E),e(b);var L=o(b,2),te=t(L,!0);e(L),e(k);var $=o(k,2),M=t($),re=t(M,!0);e(M);var F=o(M,2),ae=t(F,!0);e(F),e($);var R=o($,2),q=t(R);Le(q,{size:16,get color(){return I.gray[500]}});var A=o(q,2),se=t(A,!0);e(A),e(R);var B=o(R,2),T=t(B),K=t(T);ze(K,{size:14});var N=o(K,2),ie=t(N,!0);e(N),e(T);var oe=o(T,2);{var ne=S=>{var G=rt(),O=t(G);O.__click=[et,c,a,i,P];var ce=o(O,2);ce.__click=[tt,c,a,i,P],e(G),_(S,G)};Q(oe,S=>{r(a).status==="pending"&&S(ne)})}e(B),e(j),ve((S,G,O,ce)=>{U(z,"src",S),U(z,"alt",r(a).sender.name),v(Y,r(a).sender.name),v(ee,`@${r(a).sender.handle??""}`),we(L,1,G),v(te,O),v(re,r(a).subject),v(ae,r(a).content),v(se,r(a).email),v(ie,ce)},[()=>Ce(r(a).sender.avatar_url),()=>`rounded-full px-3 py-1 text-xs font-medium ${_e(r(a).status)}`,()=>V(r(a).status),()=>pe(r(a).created_at)]),_(x,j)}),e(l),_(p,l)};Q(g,p=>{r(f).length===0?p(w):p(D,!1)})}e(d),_(s,d)},He=s=>{var d=lt(),g=t(d);{var w=p=>{var l=ot(),x=t(l),a=t(x);je(a,{size:48,get color(){return I.gray[400]}}),e(x),be(4),e(l),_(p,l)},D=p=>{var l=dt();ye(l,21,()=>r(H),he,(x,a)=>{var j=ct(),k=t(j),b=t(k);b.__click=[nt,me,a];var z=t(b),E=o(z,2),C=t(E),Y=t(C,!0);e(C);var Z=o(C,2),ee=t(Z);e(Z),e(E),e(b);var L=o(b,2),te=t(L,!0);e(L),e(k);var $=o(k,2),M=t($),re=t(M,!0);e(M);var F=o(M,2),ae=t(F,!0);e(F),e($);var R=o($,2),q=t(R);Le(q,{size:16,get color(){return I.gray[500]}});var A=o(q,2),se=t(A,!0);e(A),e(R);var B=o(R,2),T=t(B);ze(T,{size:14});var K=o(T,2),N=t(K,!0);e(K),e(B),e(j),ve((ie,oe,ne,S)=>{U(z,"src",ie),U(z,"alt",r(a).recipient.name),v(Y,r(a).recipient.name),v(ee,`@${r(a).recipient.handle??""}`),we(L,1,oe),v(te,ne),v(re,r(a).subject),v(ae,r(a).content),v(se,r(a).email),v(N,S)},[()=>Ce(r(a).recipient.avatar_url),()=>`rounded-full px-3 py-1 text-xs font-medium ${_e(r(a).status)}`,()=>V(r(a).status),()=>pe(r(a).created_at)]),_(x,j)}),e(l),_(p,l)};Q(g,p=>{r(H).length===0?p(w):p(D,!1)})}e(d),_(s,d)};Q(Re,s=>{r(u)===0?s(Se):s(He,!1)})}e(ge),_(y,ue),Ee()}Fe(["click"]);export{St as component};
