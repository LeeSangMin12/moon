import"../chunks/CWj6FrbW.js";import{s as fe,o as ot}from"../chunks/BpDpeONt.js";import{q as Se,u as I,g as b,i as Ie,t as y,l as n,s as E,m as i,n as t,k as qe,o as h,r as s,j as ge,f as Z,x as Qe,v as O,$ as st}from"../chunks/BxrbYPPH.js";import{i as B}from"../chunks/C_-0o-f2.js";import{e as Ze,i as nt}from"../chunks/n-s4RcA1.js";import{h as it}from"../chunks/0AlaG3wI.js";import{d as Ne,r as De,h as lt}from"../chunks/DKpueC4a.js";import{s as Fe,a as U,b as ct,r as dt}from"../chunks/BGk8CD_Q.js";import{b as Ge,a as _t}from"../chunks/vV7d1D-f.js";import"../chunks/Df0q64fy.js";import{s as mt}from"../chunks/3os2E0c7.js";import"../chunks/69_IOA4Y.js";import{R as ut}from"../chunks/DgJjuvVc.js";import{G as vt,R as ft,a as gt,b as pt,d as bt,P as ht,c as xt,e as Je,f as wt,g as yt}from"../chunks/D_kLzBvZ.js";import{R as Ke}from"../chunks/bXPwB9uh.js";import{R as We}from"../chunks/BjXv7c3i.js";import"../chunks/DC-n8TqT.js";import{b as Oe}from"../chunks/DUXZVHcJ.js";import{l as de,p as D}from"../chunks/Cqu1rs7T.js";import{H as kt}from"../chunks/CATT0rBV.js";import{I as pe}from"../chunks/BtboDQMP.js";import{M as Ee}from"../chunks/IkWuq9-R.js";import{g as Xe,a as Ye,p as zt}from"../chunks/C6eE29Wt.js";import{R as Ct}from"../chunks/9gp9a86U.js";import{c as C}from"../chunks/Dcrl4MPd.js";import{g as Lt,s as ne,c as Be,b as $e}from"../chunks/iREZRceN.js";var Rt=Se('<svg><path d="M11.9999 13.1714L16.9497 8.22168L18.3639 9.63589L11.9999 15.9999L5.63599 9.63589L7.0502 8.22168L11.9999 13.1714Z"></path></svg>');function Pt(w,e){const v=de(e,["children","$$slots","$$events","$$legacy"]),o=de(v,["size","color","label","class"]);let d=D(e,"size",8,"1em"),P=D(e,"color",8,"currentColor"),f=D(e,"label",8,""),k=D(e,"class",8,"");var g=Rt();let r;I(()=>r=Fe(g,r,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:d(),height:d(),fill:P(),"aria-label":f()?f():void 0,"aria-hidden":f()?void 0:"true",role:f()?"img":void 0,class:`remixicon ri-arrow-down-s-line ${k()??""}`,...o})),b(w,g)}var At=Se('<svg><path d="M13.0001 7.82843V20H11.0001V7.82843L5.63614 13.1924L4.22192 11.7782L12.0001 4L19.7783 11.7782L18.3641 13.1924L13.0001 7.82843Z"></path></svg>');function Mt(w,e){const v=de(e,["children","$$slots","$$events","$$legacy"]),o=de(v,["size","color","label","class"]);let d=D(e,"size",8,"1em"),P=D(e,"color",8,"currentColor"),f=D(e,"label",8,""),k=D(e,"class",8,"");var g=At();let r;I(()=>r=Fe(g,r,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:d(),height:d(),fill:P(),"aria-label":f()?f():void 0,"aria-hidden":f()?void 0:"true",role:f()?"img":void 0,class:`remixicon ri-arrow-up-line ${k()??""}`,...o})),b(w,g)}var Bt=Se('<svg><path d="M11.9999 10.8284L7.0502 15.7782L5.63599 14.364L11.9999 8L18.3639 14.364L16.9497 15.7782L11.9999 10.8284Z"></path></svg>');function Dt(w,e){const v=de(e,["children","$$slots","$$events","$$legacy"]),o=de(v,["size","color","label","class"]);let d=D(e,"size",8,"1em"),P=D(e,"color",8,"currentColor"),f=D(e,"label",8,""),k=D(e,"class",8,"");var g=Bt();let r;I(()=>r=Fe(g,r,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:d(),height:d(),fill:P(),"aria-label":f()?f():void 0,"aria-hidden":f()?void 0:"true",role:f()?"img":void 0,class:`remixicon ri-arrow-up-s-line ${k()??""}`,...o})),b(w,g)}var Gt=Se('<svg><path d="M12 3C10.9 3 10 3.9 10 5C10 6.1 10.9 7 12 7C13.1 7 14 6.1 14 5C14 3.9 13.1 3 12 3ZM12 17C10.9 17 10 17.9 10 19C10 20.1 10.9 21 12 21C13.1 21 14 20.1 14 19C14 17.9 13.1 17 12 17ZM12 10C10.9 10 10 10.9 10 12C10 13.1 10.9 14 12 14C13.1 14 14 13.1 14 12C14 10.9 13.1 10 12 10Z"></path></svg>');function St(w,e){const v=de(e,["children","$$slots","$$events","$$legacy"]),o=de(v,["size","color","label","class"]);let d=D(e,"size",8,"1em"),P=D(e,"color",8,"currentColor"),f=D(e,"label",8,""),k=D(e,"class",8,"");var g=Gt();let r;I(()=>r=Fe(g,r,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:d(),height:d(),fill:P(),"aria-label":f()?f():void 0,"aria-hidden":f()?void 0:"true",role:f()?"img":void 0,class:`remixicon ri-more-2-fill ${k()??""}`,...o})),b(w,g)}const Ft=(w,e,v)=>{e.onLeaveComment?.({content:t(v)}),h(v,"")};var Ut=y('<div class="fixed bottom-0 flex w-full max-w-screen-md items-center bg-white pb-[env(safe-area-inset-bottom)] shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.05)]"><textarea rows="1" class="my-2 mr-3 ml-4 block flex-1 rounded-lg bg-gray-100 p-2 text-sm transition-all focus:outline-none" style="overflow-y: hidden;"></textarea> <button class="bg-primary mr-4 mb-3 flex h-8 w-8 items-center justify-center self-end rounded-full"><!></button></div>');function jt(w,e){Ie(e,!0);let v=D(e,"placeholder",3,"ëŒ“ê¸€ì„ ì…ë ¥í•´ì£¼ì„¸ìš”"),o=E(""),d;const P=()=>{d&&(d.style.height="auto",d.style.height=d.scrollHeight+"px")};var f=Ut(),k=n(f);De(k),k.__input=P,Oe(k,z=>d=z,()=>d);var g=i(k,2);g.__click=[Ft,e,o];var r=n(g);Mt(r,{size:20,color:"white"}),s(g),s(f),I(()=>U(k,"placeholder",v())),Ge(k,()=>t(o),z=>h(o,z)),b(w,f),qe()}Ne(["input","click"]);const Ht=(w,e,v,o,d,P,f,k)=>{h(e,v.content??o.comment.content,!0),h(d,!0),h(P,!1),setTimeout(()=>{t(f)&&(t(f).focus(),k())},0)},Tt=async(w,e,v,o,d,P,f)=>{if(!t(e).trim()){ne("error","ëŒ“ê¸€ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");return}try{const k=await v.post_comments.update(o.comment.id,d.id,t(e).trim());P.content=k.content,P.updated_at=k.updated_at,h(f,!1),ne("success","ëŒ“ê¸€ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.")}catch(k){console.error("ëŒ“ê¸€ ìˆ˜ì • ì‹¤íŒ¨:",k),ne("error","ëŒ“ê¸€ ìˆ˜ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}},Vt=(w,e,v)=>{h(e,""),h(v,!1)},Zt=async(w,e,v,o)=>{if(confirm("ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?"))try{await e.post_comments.delete(v.comment.id,o.id),v.onCommentDeleted?.({comment_id:v.comment.id,parent_comment_id:v.comment.parent_comment_id}),ne("success","ëŒ“ê¸€ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.")}catch(d){console.error("ëŒ“ê¸€ ì‚­ì œ ì‹¤íŒ¨:",d),ne("error","ëŒ“ê¸€ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}},Ot=(w,e)=>{t(e)&&(t(e).style.height="auto",t(e).style.height=t(e).scrollHeight+"px")};var Et=y('<div class="flex w-full flex-col items-center rounded-lg bg-white"><button class="flex w-full items-center gap-3 p-3" aria-label="ëŒ“ê¸€ ìˆ˜ì •í•˜ê¸°"><!> <p class="text-gray-600">ìˆ˜ì •í•˜ê¸°</p></button> <hr class="w-full border-gray-100"> <button class="flex w-full items-center gap-3 p-3" aria-label="ëŒ“ê¸€ ì‚­ì œí•˜ê¸°"><!> <p class="text-red-500">ì‚­ì œí•˜ê¸°</p></button></div>'),It=(w,e)=>{ne("info","ì‹ ê³  ê¸°ëŠ¥ì€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤."),h(e,!1)},qt=y('<div class="flex w-full flex-col items-center rounded-lg bg-white"><button class="flex w-full items-center gap-3 p-3" aria-label="ëŒ“ê¸€ ì‹ ê³ í•˜ê¸°"><!> <p class="text-gray-600">ì‹ ê³ í•˜ê¸°</p></button></div>'),Nt=y('<div class="flex flex-col items-center bg-gray-100 p-4 text-sm font-medium"><!></div>'),Jt=y('<span class="text-xs text-gray-400">(ìˆ˜ì •ë¨)</span>'),Kt=y('<div class="bg-primary mr-2 inline-block flex-col rounded px-2 py-0.5 text-xs text-white"><span class="mr-1">ğŸŒ™</span> </div>'),Qt=y('<div class="mt-1 flex items-start"><textarea rows="1" placeholder="ëŒ“ê¸€ì„ ì…ë ¥í•´ì£¼ì„¸ìš”" class="w-full flex-1 resize-none rounded-lg bg-gray-100 p-2 text-sm focus:outline-none"></textarea> <button class="btn btn-sm ml-2 rounded-md bg-blue-500 px-3 py-2 text-xs text-white">ì €ì¥</button> <button class="btn btn-gray btn-sm ml-2 rounded-md px-3 py-2 text-xs">ì·¨ì†Œ</button></div>'),Wt=y('<p class="mt-1 whitespace-pre-wrap"> </p>'),Xt=(w,e)=>e(1),Yt=(w,e)=>e(-1),$t=(w,e)=>h(e,!t(e)),er=(w,e)=>h(e,!0),tr=y('<div class="mt-2 flex items-center justify-between text-sm text-gray-400"><div class="flex items-center gap-3 text-xs"><button class="flex items-center gap-1" aria-label="ì¢‹ì•„ìš”"><!> <p> </p></button> <button class="flex items-center" aria-label="ì‹«ì–´ìš”"><!></button> <button class="flex items-center gap-1" aria-label="ë‹µê¸€ ì‘ì„±"><!> <p>ë‹µê¸€</p></button> <button class="flex items-center gap-1" aria-label="ì„ ë¬¼í•˜ê¸°"><!></button></div></div>'),rr=(w,e)=>h(e,!0),ar=y('<button aria-label="ëŒ“ê¸€ ë©”ë‰´ ì—´ê¸°"><!></button>'),or=(w,e)=>h(e,!1),sr=y('<div class="mt-2 ml-10 flex items-start"><textarea rows="1" placeholder="ë‹µê¸€ì„ ì…ë ¥í•´ì£¼ì„¸ìš”" class="w-full flex-1 resize-none rounded-lg bg-gray-100 p-2 text-sm focus:outline-none"></textarea> <button class="btn btn-sm ml-2 rounded-md bg-blue-500 px-3 py-2 text-xs text-white">ë“±ë¡</button> <button class="btn btn-gray btn-sm ml-2 rounded-md px-3 py-2 text-xs">ì·¨ì†Œ</button></div>'),nr=(w,e)=>h(e,!t(e)),ir=y('<div class="mt-3 ml-10 space-y-3"></div>'),lr=y('<button class="mt-4 ml-10 flex items-center text-xs text-blue-500 hover:underline"><!> </button> <!>',1),cr=y('<!> <!> <div class="flex flex-col"><div class="flex w-full items-start justify-between"><div class="flex gap-3"><a class="h-8 w-8 flex-shrink-0"><img alt="í”„ë¡œí•„" class="block aspect-square h-full w-full rounded-full object-cover" loading="lazy"></a> <div class="w-full"><div class="mb-0.5 flex items-center gap-2"><a class="text-sm font-medium text-black"> </a> <span class="text-xs text-gray-400"> </span> <!></div> <div class="text-sm text-gray-800"><!> <!></div> <!></div></div> <!></div> <!> <!></div>',1);function et(w,e){Ie(e,!0);const v=Xe(),o=Ye();let d=E(""),P=E(!1),f=E(!1),k=E(!1),g=ge({user_vote:null,upvotes:null,downvotes:null}),r=ge({content:null,updated_at:null}),z=E(!1),oe=E(""),ie=E(!1),_e=E(null),q=E(null);const ee=async a=>{if(!Be(v))return;const m=g.user_vote??e.comment.user_vote,u=g.upvotes??e.comment.upvotes,x=g.downvotes??e.comment.downvotes;m===a?(await o.post_comment_votes.delete(e.comment.id,v.id),g.user_vote=0,a===1?g.upvotes=u-1:g.downvotes=x-1):(await o.post_comment_votes.upsert({comment_id:e.comment.id,user_id:v.id,vote:a}),g.user_vote=a,a===1?(g.upvotes=u+1,m===-1&&(g.downvotes=x-1)):(g.downvotes=x+1,m===1&&(g.upvotes=u-1))),e.onVoteChanged?.({comment_id:e.comment.id,user_vote:g.user_vote,upvotes:g.upvotes,downvotes:g.downvotes})},te=async()=>{const a=await o.post_comments.insert({post_id:e.post_id,user_id:v.id,content:t(d).trim(),parent_comment_id:e.comment.id});a.post_comment_votes=[],a.upvotes=0,a.downvotes=0,a.user_vote=0,a.replies=[],a.users={id:v.id,handle:v.handle,avatar_url:v.avatar_url},e.onReplyAdded?.({parent_comment_id:e.comment.id,new_reply:a}),h(d,""),h(P,!1),h(f,!0)};async function Ue({gift_content:a,gift_moon_point:m,post_id:u}){e.onGiftCommentAdded?.({gift_content:a,gift_moon_point:m,parent_comment_id:e.comment.id,post_id:e.post_id}),h(k,!1)}const ke=a=>{e.onReplyAdded?.(a)},ze=a=>{e.onGiftCommentAdded?.(a)},je=a=>{e.onCommentDeleted?.(a)},He=a=>{e.onVoteChanged?.(a)},Ce=()=>{t(q)&&(t(q).style.height="auto",t(q).style.height=t(q).scrollHeight+"px")},Le=Qe(()=>e.comment.users?.id===v.id);var Re=cr(),Pe=Z(Re);vt(Pe,{get receiver_id(){return e.comment.users.id},get receiver_name(){return e.comment.users.name},onGiftSuccess:Ue,get is_modal_open(){return t(k)},set is_modal_open(a){h(k,a,!0)}});var he=i(Pe,2);Ee(he,{modal_position:"bottom",get is_modal_open(){return t(ie)},set is_modal_open(a){h(ie,a,!0)},children:(a,m)=>{var u=Nt(),x=n(u);{var R=se=>{var X=Et(),Y=n(X);Y.__click=[Ht,oe,r,e,z,ie,q,Ce];var F=n(Y);We(F,{size:20,get color(){return C.gray[600]}}),O(2),s(Y);var $=i(Y,4);$.__click=[Zt,o,e,v];var ve=n($);Ct(ve,{size:20,get color(){return C.warning}}),O(2),s($),s(X),b(se,X)},A=se=>{var X=qt(),Y=n(X);Y.__click=[It,ie];var F=n(Y);pe(F,{attribute:"exclamation",size:20,get color(){return C.warning}}),O(2),s(Y),s(X),b(se,X)};B(x,se=>{t(Le)?se(R):se(A,!1)})}s(u),b(a,u)},$$slots:{default:!0}});var xe=i(he,2),be=n(xe),me=n(be),ue=n(me),Ae=n(ue);s(ue);var we=i(ue,2),ye=n(we),l=n(ye),p=n(l);s(l);var _=i(l,2),L=n(_,!0);s(_);var c=i(_,2);{var N=a=>{var m=Jt();b(a,m)};B(c,a=>{(r.updated_at??e.comment.updated_at)&&(r.updated_at??e.comment.updated_at)!==e.comment.created_at&&a(N)})}s(ye);var G=i(ye,2),H=n(G);{var T=a=>{var m=Kt(),u=i(n(m));s(m),I(()=>fe(u,` ${e.comment.gift_moon_point??""}`)),b(a,m)};B(H,a=>{e.comment.gift_moon_point&&a(T)})}var M=i(H,2);{var J=a=>{var m=Qt(),u=n(m);De(u),u.__input=Ce,Oe(u,A=>h(q,A),()=>t(q));var x=i(u,2);x.__click=[Tt,oe,o,e,v,r,z];var R=i(x,2);R.__click=[Vt,oe,z],s(m),Ge(u,()=>t(oe),A=>h(oe,A)),b(a,m)},K=a=>{var m=Wt(),u=n(m,!0);s(m),I(()=>fe(u,r.content??e.comment.content)),b(a,m)};B(M,a=>{t(z)?a(J):a(K,!1)})}s(G);var Q=i(G,2);{var S=a=>{var m=tr(),u=n(m),x=n(u);x.__click=[Xt,ee];var R=n(x);{var A=j=>{ft(j,{size:16,get color(){return C.primary}})},se=j=>{gt(j,{size:16,get color(){return C.gray[400]}})};B(R,j=>{(g.user_vote??e.comment.user_vote)===1?j(A):j(se,!1)})}var X=i(R,2);let Y;var F=n(X,!0);s(X),s(x);var $=i(x,2);$.__click=[Yt,ee];var ve=n($);{var Te=j=>{pt(j,{size:16,get color(){return C.warning}})},tt=j=>{bt(j,{size:16,get color(){return C.gray[400]}})};B(ve,j=>{(g.user_vote??e.comment.user_vote)===-1?j(Te):j(tt,!1)})}s($);var Me=i($,2);Me.__click=[$t,P];var rt=n(Me);pe(rt,{attribute:"chat_bubble",size:16,get color(){return C.gray[400]}}),O(2),s(Me);var Ve=i(Me,2);Ve.__click=[er,k];var at=n(Ve);pe(at,{attribute:"gift",size:16,get color(){return C.gray[400]}}),s(Ve),s(u),s(m),I(j=>{Y=ct(X,1,"",null,Y,j),fe(F,g.upvotes??e.comment.upvotes)},[()=>({"text-primary":(g.user_vote??e.comment.user_vote)===1})]),b(a,m)};B(Q,a=>{t(z)||a(S)})}s(we),s(me);var W=i(me,2);{var V=a=>{var m=ar();m.__click=[rr,ie];var u=n(m);St(u,{size:16,get color(){return C.gray[500]}}),s(m),b(a,m)};B(W,a=>{t(z)||a(V)})}s(be);var re=i(be,2);{var ce=a=>{var m=sr(),u=n(m);De(u),u.__input=[Ot,_e],Oe(u,A=>h(_e,A),()=>t(_e));var x=i(u,2);x.__click=te;var R=i(x,2);R.__click=[or,P],s(m),Ge(u,()=>t(d),A=>h(d,A)),b(a,m)};B(re,a=>{t(P)&&!t(z)&&a(ce)})}var ae=i(re,2);{var le=a=>{var m=lr(),u=Z(m);u.__click=[nr,f];var x=n(u);{var R=F=>{Dt(F,{size:16,get color(){return C.primary}})},A=F=>{Pt(F,{size:16,get color(){return C.primary}})};B(x,F=>{t(f)?F(R):F(A,!1)})}var se=i(x);s(u);var X=i(u,2);{var Y=F=>{var $=ir();Ze($,21,()=>e.comment.replies,ve=>ve.id,(ve,Te)=>{et(ve,{get post_id(){return e.post_id},get comment(){return t(Te)},onReplyAdded:ke,onGiftCommentAdded:ze,onCommentDeleted:je,onVoteChanged:He})}),s($),b(F,$)};B(X,F=>{t(f)&&F(Y)})}I(()=>{U(u,"aria-label",t(f)?`ë‹µê¸€ ${e.comment.replies.length}ê°œ ìˆ¨ê¸°ê¸°`:`ë‹µê¸€ ${e.comment.replies.length}ê°œ ë³´ê¸°`),fe(se,` ë‹µê¸€ ${e.comment.replies.length??""}ê°œ`)}),b(a,m)};B(ae,a=>{e.comment.replies?.length>0&&a(le)})}s(xe),I(a=>{U(ue,"href",e.comment.users?.handle?`/@${e.comment.users.handle}`:"#"),U(Ae,"src",e.comment.users?.avatar_url??zt),U(l,"href",e.comment.users?.handle?`/@${e.comment.users.handle}`:"#"),fe(p,`@${e.comment.users?.handle??"ì•Œ ìˆ˜ ì—†ìŒ"??""}`),fe(L,a)},[()=>Lt(new Date(e.comment.created_at))]),b(w,Re),qe()}Ne(["click","input"]);var dr=y('<meta property="og:image"> <meta name="twitter:image">',1),_r=y('<meta name="description"> <link rel="canonical"> <meta property="og:type" content="article"> <meta property="og:url"> <meta property="og:title"> <meta property="og:description"> <meta property="og:image:width" content="1200"> <meta property="og:image:height" content="630"> <meta name="twitter:card" content="summary_large_image"> <meta name="twitter:url"> <meta name="twitter:title"> <meta name="twitter:description"> <!> <!>',1),mr=y('<button slot="left" class="flex items-center"><!></button>'),ur=y('<h1 slot="center" class="text-medium"></h1>'),vr=y('<button slot="right"><!></button>'),fr=y('<!> <p class="text-gray-600">ì €ì¥ë¨</p>',1),gr=y('<!> <p class="text-gray-600">ì €ì¥í•˜ê¸°</p>',1),pr=(w,e)=>{$e(`${window.location.origin}/@${t(e).users?.handle||"unknown"}/post/${t(e).id}`,"ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.")},br=y('<div class="flex w-full flex-col items-center rounded-lg bg-white"><a class="flex w-full items-center gap-3 p-3"><!> <p class="text-gray-600">ìˆ˜ì •í•˜ê¸°</p></a> <hr class=" w-full border-gray-100"> <button class="flex w-full items-center gap-3 p-3"><!></button></div> <button class="mt-4 flex w-full flex-col items-center rounded-lg bg-white"><div class="flex w-full items-center gap-3 p-3"><!> <p class="text-gray-600">ë§í¬ë³µì‚¬</p></div></button>',1),hr=y('<!> <p class="text-gray-600">ì €ì¥ë¨</p>',1),xr=y('<!> <p class="text-gray-600">ì €ì¥í•˜ê¸°</p>',1),wr=y('<!> <p class="text-gray-600">íŒ”ë¡œìš° ì·¨ì†Œ</p>',1),yr=y('<!> <p class="text-gray-600">íŒ”ë¡œìš°</p>',1),kr=(w,e)=>{$e(`${window.location.origin}/@${t(e).users?.handle||"unknown"}/post/${t(e).id}`,"ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.")},zr=(w,e)=>e.report=!0,Cr=y('<div class="flex w-full flex-col items-center rounded-lg bg-white"><button class="flex w-full items-center gap-3 p-3"><!></button> <hr class=" w-full border-gray-100"> <button class="flex w-full items-center gap-3 p-3"><!></button></div> <button class="mt-4 flex w-full flex-col items-center rounded-lg bg-white"><div class="flex w-full items-center gap-3 p-3"><!> <p class="text-gray-600">ë§í¬ë³µì‚¬</p></div></button> <button class="mt-4 flex w-full flex-col items-center rounded-lg bg-white"><div class="flex w-full items-center gap-2 p-3"><!> <p class="text-red-500">ì‹ ê³ í•˜ê¸°</p></div></button>',1),Lr=y('<div class="flex flex-col items-center bg-gray-100 p-4 text-sm font-medium"><!></div>'),Rr=y('<label class="flex items-center"><input type="radio" name="report_reason" class="radio radio-primary radio-xs"> <span class="ml-2"> </span></label>'),Pr=(w,e)=>e.report=!1,Ar=y('<div class="p-4"><h2 class="text-lg font-bold">ë¬´ì—‡ì„ ì‹ ê³ í•˜ì‹œë‚˜ìš”?</h2> <p class="mt-1 text-sm text-gray-500">ì»¤ë®¤ë‹ˆí‹° ê°€ì´ë“œë¼ì¸ì— ì–´ê¸‹ë‚˜ëŠ” ë‚´ìš©ì„ ì•Œë ¤ì£¼ì„¸ìš”.</p> <div class="mt-4 space-y-2"></div> <textarea class="textarea textarea-bordered focus:border-primary mt-4 w-full focus:outline-none" placeholder="ìƒì„¸ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”. (ì„ íƒ ì‚¬í•­)" rows="3"></textarea></div> <div class="flex"><button class="btn w-1/3 rounded-none">ì·¨ì†Œ</button> <button class="btn btn-primary w-2/3 rounded-none">ì œì¶œ</button></div>',1),Mr=y('<!> <!> <main><div class="space-y-4 p-4"></div></main> <!> <!> <!>',1);function aa(w,e){Ie(e,!0);const v=[],o=Xe(),d=Ye(),P=["ìŠ¤íŒ¸/ê´‘ê³ ì„± ì½˜í…ì¸ ì…ë‹ˆë‹¤.","ìš•ì„¤/í˜ì˜¤ ë°œì–¸ì„ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.","ì„ ì •ì ì¸ ë‚´ìš©ì„ í¬í•¨í•˜ê³  ìˆìŠµë‹ˆë‹¤.","ì˜ëª»ëœ ì •ë³´ë¥¼ í¬í•¨í•˜ê³  ìˆìŠµë‹ˆë‹¤.","ê¸°íƒ€"];let{post:f,comments:k,page_url:g}=e.data,r=E(ge(f)),z=E(ge(k)),oe=ge(g),ie=Qe(()=>o?.id&&t(r).post_bookmarks?t(r).post_bookmarks.some(l=>l.user_id===o.id):!1),_e=E(!1),q=E(!1),ee=ge({post_config:!1,report:!1}),te=ge({reason:"",details:""});ot(async()=>{o?.id&&h(q,await d.user_follows.is_following(o.id,t(r).users.id),!0)});const Ue=async({content:l})=>{const p=await d.post_comments.insert({post_id:t(r).id,user_id:o.id,content:l.trim()});p.post_comment_votes=[],p.upvotes=0,p.downvotes=0,p.user_vote=0,p.replies=[],p.users={id:o.id,handle:o.handle,avatar_url:o.avatar_url},h(z,[...t(z),p],!0);try{t(r)?.users?.id&&t(r).users.id!==o.id&&await d.notifications.insert({recipient_id:t(r).users.id,actor_id:o.id,type:"comment.created",resource_type:"post",resource_id:String(t(r).id),payload:{comment_id:p.id,post_id:t(r).id,preview:p.content?.slice(0,80)},link_url:`/@${t(r).users?.handle||"unknown"}/post/${t(r).id}#comment-${p.id}`})}catch(_){console.error("Failed to insert notification (comment.created):",_)}},ke=async({parent_comment_id:l,new_reply:p})=>{const _=L=>L.map(c=>c.id===l?{...c,replies:[...c.replies||[],p]}:c.replies&&c.replies.length>0?{...c,replies:_(c.replies)}:c);h(z,_(t(z)),!0);try{const c=t(z).find(N=>N.id===l)?.user_id;c&&c!==o.id&&await d.notifications.insert({recipient_id:c,actor_id:o.id,type:"comment.reply",resource_type:"post",resource_id:String(t(r).id),payload:{comment_id:p.id,parent_comment_id:l,post_id:t(r).id,preview:p.content?.slice(0,80)},link_url:`/@${t(r).users?.handle||"unknown"}/post/${t(r).id}#comment-${p.id}`})}catch(L){console.error("Failed to insert notification (comment.reply):",L)}},ze=async({gift_content:l,gift_moon_point:p,parent_comment_id:_,post_id:L})=>{const c=await d.post_comments.insert({post_id:t(r).id,user_id:o.id,content:l,parent_comment_id:_,gift_moon_point:p});c.post_comment_votes=[],c.upvotes=0,c.downvotes=0,c.user_vote=0,c.replies=[],c.users={id:o.id,handle:o.handle,avatar_url:o.avatar_url},_?ke({parent_comment_id:_,new_reply:c}):h(z,[...t(z),c],!0)},{handle_bookmark_changed:je,handle_vote_changed:He}=xt(()=>[t(r)],l=>{h(r,l[0],!0)},o),Ce=({comment_id:l,parent_comment_id:p})=>{if(p){const _=L=>L.map(c=>c.id===p?{...c,replies:c.replies.filter(N=>N.id!==l)}:c.replies&&c.replies.length>0?{...c,replies:_(c.replies)}:c);h(z,_(t(z)),!0)}else h(z,t(z).filter(_=>_.id!==l),!0)};async function Le(){if(!Be(o)||t(_e))return;h(_e,!0);const l=t(r).post_bookmarks;try{t(ie)?(t(r).post_bookmarks=t(r).post_bookmarks.filter(p=>p.user_id!==o.id),await d.post_bookmarks.delete(t(r).id,o.id)):(t(r).post_bookmarks=[...t(r).post_bookmarks,{user_id:o.id}],await d.post_bookmarks.insert(t(r).id,o.id))}catch(p){console.error("Bookmark toggle failed:",p),t(r).post_bookmarks=l,ne("error","ë¶ë§ˆí¬ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}finally{h(_e,!1)}}const Re=async()=>{Be(o)&&(t(q)?(await d.user_follows.unfollow(o.id,t(r).users.id),o.user_follows=o.user_follows.filter(l=>l.following_id!==t(r).users.id)):(await d.user_follows.follow(o.id,t(r).users.id),o.user_follows.push({following_id:t(r).users.id})),h(q,!t(q)))},Pe=async()=>{if(te.reason===""){ne("error","ì‹ ê³  ì‚¬ìœ ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.");return}try{await d.post_reports.insert({reporter_id:o.id,post_id:t(r).id,reason:te.reason,details:te.details}),ne("success","ì‹ ê³ ê°€ ì •ìƒì ìœ¼ë¡œ ì ‘ìˆ˜ë˜ì—ˆìŠµë‹ˆë‹¤.")}catch(l){console.error("Failed to submit report:",l),ne("error","ì‹ ê³  ì ‘ìˆ˜ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}finally{ee.report=!1,te.reason="",te.details=""}};var he=Mr();lt(l=>{var p=_r(),_=Z(p),L=i(_,2),c=i(L,4),N=i(c,2),G=i(N,2),H=i(G,8),T=i(H,2),M=i(T,2),J=i(M,2);{var K=S=>{var W=dr(),V=Z(W),re=i(V,2);I(()=>{U(V,"content",t(r).images[0].uri),U(re,"content",t(r).images[0].uri)}),b(S,W)};B(J,S=>{t(r).images?.length>0&&S(K)})}var Q=i(J,2);it(Q,()=>`<script type="application/ld+json">${JSON.stringify({"@context":"https://schema.org","@type":"Article",headline:t(r).title,description:(t(r).content??"").slice(0,200),image:t(r)?.images?.[0]?.uri?[t(r).images[0].uri]:void 0,author:t(r)?.users?.name?{"@type":"Person",name:t(r).users.name}:void 0,datePublished:t(r)?.created_at,dateModified:t(r)?.updated_at??t(r)?.created_at,mainEntityOfPage:oe})}<\/script>`),I((S,W,V)=>{st.title=`${t(r).title??""} | ë¬¸`,U(_,"content",S),U(L,"href",oe),U(c,"content",oe),U(N,"content",t(r).title),U(G,"content",W),U(H,"content",oe),U(T,"content",t(r).title),U(M,"content",V)},[()=>(t(r).content??"").slice(0,160),()=>(t(r).content??"").slice(0,200),()=>(t(r).content??"").slice(0,200)]),b(l,p)});var xe=Z(he);kt(xe,{$$slots:{left:(l,p)=>{var _=mr();_.__click=function(...c){mt?.apply(this,c)};var L=n(_);ut(L,{size:28,get color(){return C.gray[600]}}),s(_),b(l,_)},center:(l,p)=>{var _=ur();_.textContent="ê²Œì‹œê¸€",b(l,_)},right:(l,p)=>{var _=vr();_.__click=()=>{Be(o)&&(ee.post_config=!0)};var L=n(_);pe(L,{attribute:"menu",size:24,get color(){return C.gray[600]}}),s(_),b(l,_)}}});var be=i(xe,2);ht(be,{get post(){return t(r)},onGiftCommentAdded:ze,onBookmarkChanged:je,onVoteChanged:He});var me=i(be,2),ue=n(me);Ze(ue,21,()=>t(z),l=>l.id,(l,p)=>{et(l,{get post_id(){return t(r).id},get comment(){return t(p)},onReplyAdded:ke,onGiftCommentAdded:ze,onCommentDeleted:Ce})}),s(ue),s(me);var Ae=i(me,2);jt(Ae,{onLeaveComment:Ue});var we=i(Ae,2);Ee(we,{modal_position:"bottom",get is_modal_open(){return ee.post_config},set is_modal_open(l){ee.post_config=l},children:(l,p)=>{var _=Lr(),L=n(_);{var c=G=>{var H=br(),T=Z(H),M=n(T),J=n(M);We(J,{size:20,get color(){return C.gray[400]}}),O(2),s(M);var K=i(M,4);K.__click=Le;var Q=n(K);{var S=ae=>{var le=fr(),a=Z(le);Je(a,{size:20,get color(){return C.primary}}),O(2),b(ae,le)},W=ae=>{var le=gr(),a=Z(le);Ke(a,{size:20,get color(){return C.gray[400]}}),O(2),b(ae,le)};B(Q,ae=>{t(ie)?ae(S):ae(W,!1)})}s(K),s(T);var V=i(T,2);V.__click=[pr,r];var re=n(V),ce=n(re);pe(ce,{attribute:"link",size:20,get color(){return C.gray[600]}}),O(2),s(re),s(V),I(()=>U(M,"href",`/regi/post/${t(r).id}`)),b(G,H)},N=G=>{var H=Cr(),T=Z(H),M=n(T);M.__click=Le;var J=n(M);{var K=x=>{var R=hr(),A=Z(R);Je(A,{size:20,get color(){return C.primary}}),O(2),b(x,R)},Q=x=>{var R=xr(),A=Z(R);Ke(A,{size:20,get color(){return C.gray[600]}}),O(2),b(x,R)};B(J,x=>{t(ie)?x(K):x(Q,!1)})}s(M);var S=i(M,4);S.__click=Re;var W=n(S);{var V=x=>{var R=wr(),A=Z(R);wt(A,{size:20,get color(){return C.gray[600]}}),O(2),b(x,R)},re=x=>{var R=yr(),A=Z(R);yt(A,{size:20,get color(){return C.gray[600]}}),O(2),b(x,R)};B(W,x=>{t(q)?x(V):x(re,!1)})}s(S),s(T);var ce=i(T,2);ce.__click=[kr,r];var ae=n(ce),le=n(ae);pe(le,{attribute:"link",size:20,get color(){return C.gray[600]}}),O(2),s(ae),s(ce);var a=i(ce,2);a.__click=[zr,ee];var m=n(a),u=n(m);pe(u,{attribute:"exclamation",size:24,get color(){return C.warning}}),O(2),s(m),s(a),b(G,H)};B(L,G=>{t(r).users.id===o.id?G(c):G(N,!1)})}s(_),b(l,_)},$$slots:{default:!0}});var ye=i(we,2);Ee(ye,{modal_position:"center",get is_modal_open(){return ee.report},set is_modal_open(l){ee.report=l},children:(l,p)=>{var _=Ar(),L=Z(_),c=i(n(L),4);Ze(c,21,()=>P,nt,(M,J)=>{var K=Rr(),Q=n(K);dt(Q);var S,W=i(Q,2),V=n(W,!0);s(W),s(K),I(()=>{S!==(S=t(J))&&(Q.value=(Q.__value=t(J))??""),fe(V,t(J))}),_t(v,[],Q,()=>(t(J),te.reason),re=>te.reason=re),b(M,K)}),s(c);var N=i(c,2);De(N),s(L);var G=i(L,2),H=n(G);H.__click=[Pr,ee];var T=i(H,2);T.__click=Pe,s(G),Ge(N,()=>te.details,M=>te.details=M),b(l,_)},$$slots:{default:!0}}),b(w,he),qe()}Ne(["click"]);export{aa as component};
